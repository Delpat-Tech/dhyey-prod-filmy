(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3159],{25498:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},18365:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},23587:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},33085:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},60028:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},94008:function(e,t,s){Promise.resolve().then(s.bind(s,34214))},34214:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return EditProfilePage}});var a=s(37821),r=s(58078),o=s(96871),i=s.n(o),n=s(45039),l=s.n(n),c=s(25498),d=s(33085),u=s(18365),h=s(60028),m=s(23587),p=s(8494);function EditProfilePage(){let[e,t]=(0,r.useState)({name:"",username:"",bio:"",location:"",website:""}),[s,o]=(0,r.useState)(""),[n,g]=(0,r.useState)(!0),[y,f]=(0,r.useState)(!1),[x,b]=(0,r.useState)(""),[v,S]=(0,r.useState)(null);(0,r.useEffect)(()=>{fetchUserData()},[]);let fetchUserData=async()=>{try{let e=await p.TV.getMe(),s=e.data.user;t({name:s.name||"",username:s.username||"",bio:s.bio||"",location:s.location||"",website:s.website||""}),o(s.avatar||"")}catch(e){console.error("Error fetching user data:",e),b("Failed to load user data")}finally{g(!1)}},handleSubmit=async t=>{t.preventDefault(),f(!0),b("");try{v&&await uploadPhoto(),await p.TV.updateMe(e),b("Profile updated successfully!")}catch(e){var s,a;b((null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||"Failed to update profile")}finally{f(!1)}},uploadPhoto=async()=>{if(!v)return;let e=new FormData;e.append("avatar",v);try{let t=await p.TV.updateMe(e);o(t.data.user.avatar),S(null)}catch(e){console.error("Photo upload failed:",e)}};return n?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading profile..."})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsx)("div",{className:"bg-white border-b border-gray-200 px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(i(),{href:"/profile",className:"text-gray-600 hover:text-gray-900 transition-colors",children:(0,a.jsx)(c.Z,{size:20})}),(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Edit Profile"})]}),(0,a.jsxs)("button",{onClick:handleSubmit,disabled:y,className:"bg-purple-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-purple-700 transition-colors flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)(d.Z,{size:16}),(0,a.jsx)("span",{children:y?"Saving...":"Save Changes"})]})]})}),(0,a.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(l(),{src:s||"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=150&h=150&fit=crop&crop=face",alt:"Profile",width:100,height:100,className:"rounded-full object-cover border-4 border-gray-100"}),(0,a.jsx)("input",{type:"file",id:"profilePhoto",accept:"image/*",className:"hidden",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){S(s);let e=URL.createObjectURL(s);o(e)}}}),(0,a.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=document.getElementById("profilePhoto"))||void 0===e?void 0:e.click()},className:"absolute bottom-0 right-0 bg-purple-600 text-white p-2 rounded-full hover:bg-purple-700 transition-colors shadow-lg",children:(0,a.jsx)(u.Z,{size:16})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:"Profile Photo"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Click the camera icon to update your photo"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"JPG, PNG or GIF. Max size 5MB."})]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(h.Z,{size:20,className:"text-gray-600"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Personal Information"})]})}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),(0,a.jsx)("input",{type:"text",value:e.name,onChange:s=>t({...e,name:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 bg-white transition-colors",placeholder:"Enter your full name"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),(0,a.jsx)("input",{type:"text",value:e.username,onChange:s=>t({...e,username:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 bg-white transition-colors",placeholder:"Choose a unique username"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(m.Z,{size:20,className:"text-gray-600"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"About & Location"})]})}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),(0,a.jsx)("textarea",{value:e.bio,onChange:s=>t({...e,bio:s.target.value}),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none text-gray-900 bg-white transition-colors",placeholder:"Tell us about yourself..."}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Max 500 characters"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),(0,a.jsx)("input",{type:"text",value:e.location,onChange:s=>t({...e,location:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 bg-white transition-colors",placeholder:"City, Country"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),(0,a.jsx)("input",{type:"url",value:e.website,onChange:s=>t({...e,website:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 bg-white transition-colors",placeholder:"https://yourwebsite.com"})]})]})]})]}),x&&(0,a.jsx)("div",{className:"p-4 rounded-lg text-center font-medium ".concat(x.includes("successfully")?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"),children:x})]})]})})}},8494:function(e,t,s){"use strict";s.d(t,{OF:function(){return n},Sb:function(){return l},TV:function(){return o},fh:function(){return i},kv:function(){return r}});let a="https://api.dhyey.delpat.in/api/v1",apiRequest=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=localStorage.getItem("dhyey_token"),r=localStorage.getItem("dhyey_token_expiry");if(s&&r&&new Date().getTime()>parseInt(r))throw console.log("Token expired, clearing session"),localStorage.removeItem("dhyey_user"),localStorage.removeItem("dhyey_token"),localStorage.removeItem("dhyey_token_expiry"),localStorage.removeItem("dhyey_remember_me"),window.location.pathname.includes("/auth/")||(window.location.href="/auth/login"),Error("Session expired. Please log in again.");let o={...t,headers:{"Content-Type":"application/json",...s&&{Authorization:"Bearer ".concat(s)},...t.headers},...s&&{credentials:"include"}},i=await fetch("".concat(a).concat(e),o);if(401===i.status){if(e.includes("/auth/update-password")||e.includes("/auth/change-password")){let e=await i.json().catch(()=>({}));throw Error(e.message||"Current password is incorrect")}throw console.log("Unauthorized request, clearing session"),localStorage.removeItem("dhyey_user"),localStorage.removeItem("dhyey_token"),localStorage.removeItem("dhyey_token_expiry"),localStorage.removeItem("dhyey_remember_me"),window.location.pathname.includes("/auth/")||(window.location.href="/auth/login"),Error("Session expired. Please log in again.")}if(!i.ok){let e=await i.json().catch(()=>({}));throw Error(e.message||"HTTP error! status: ".concat(i.status))}return i.json()},r={login:(e,t)=>fetch("".concat(a,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(async e=>{if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.message||"HTTP error! status: ".concat(e.status))}return e.json()}),register:e=>fetch("".concat(a,"/auth/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(async e=>{let t=await e.json();if(!e.ok)throw Error(t.message||"HTTP error! status: ".concat(e.status));return t}),forgotPassword:e=>apiRequest("/auth/forgot-password",{method:"POST",body:JSON.stringify({email:e})}),resetPassword:(e,t,s)=>apiRequest("/auth/reset-password/".concat(e),{method:"PATCH",body:JSON.stringify({password:t,passwordConfirm:s})}),updatePassword:(e,t,s)=>apiRequest("/auth/update-password",{method:"PATCH",body:JSON.stringify({passwordCurrent:e,password:t,passwordConfirm:s})}),changePassword:(e,t,s)=>apiRequest("/auth/change-password",{method:"PATCH",body:JSON.stringify({passwordCurrent:e,password:t,passwordConfirm:s})}),logout:()=>apiRequest("/auth/logout",{method:"POST"}),refreshToken:()=>apiRequest("/auth/refresh-token",{method:"POST"})},o={getMe:()=>apiRequest("/users/me"),updateMe:e=>apiRequest("/users/me",{method:"PATCH",body:JSON.stringify(e)}),getUserProfile:e=>apiRequest("/users/profile/".concat(e)),followUser:e=>apiRequest("/users/".concat(e,"/follow"),{method:"POST"}),getUserFollowers:e=>apiRequest("/users/".concat(e,"/followers")),getUserFollowing:e=>apiRequest("/users/".concat(e,"/following")),getUserSavedStories:e=>apiRequest("/users/".concat(e,"/saved")),getUserLikedStories:()=>apiRequest("/users/me/liked"),getAllUsers:()=>apiRequest("/users/admin/all")},i={getPublicStories:e=>apiRequest("/stories".concat(e?"?".concat(e):"")),getStoryById:e=>apiRequest("/stories/".concat(e)),createStory:e=>apiRequest("/stories",{method:"POST",body:JSON.stringify(e)}),updateStory:(e,t)=>apiRequest("/stories/".concat(e),{method:"PATCH",body:JSON.stringify(t)}),deleteStory:e=>apiRequest("/stories/".concat(e),{method:"DELETE"}),likeStory:e=>apiRequest("/stories/".concat(e,"/like"),{method:"POST"}),saveStory:e=>apiRequest("/stories/".concat(e,"/save"),{method:"POST"}),shareStory:(e,t)=>apiRequest("/stories/".concat(e,"/share"),{method:"POST",body:JSON.stringify(t||{})}),getUserStories:e=>apiRequest("/stories/user/".concat(e)),searchStories:(e,t)=>{let s=new URLSearchParams({q:e,...t});return apiRequest("/stories/search?".concat(s))},getStoryComments:e=>apiRequest("/stories/".concat(e,"/comments")),addComment:(e,t,s)=>apiRequest("/stories/".concat(e,"/comments"),{method:"POST",body:JSON.stringify({content:t,parentComment:s})}),likeComment:(e,t)=>apiRequest("/stories/".concat(e,"/comments/").concat(t,"/like"),{method:"POST"})},n={searchStories:(e,t)=>{let s=t?Object.fromEntries(Object.entries(t).filter(e=>{let[t,s]=e;return null!=s&&""!==s})):{},a=new URLSearchParams({q:e,...s});return console.log("API call URL:","/search/stories?".concat(a)),apiRequest("/search/stories?".concat(a))},searchUsers:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/users?".concat(t))},getSearchSuggestions:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/suggestions?".concat(t))},getSearchFilters:()=>apiRequest("/search/filters"),globalSearch:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/global?".concat(t))}},l={getAllStories:e=>apiRequest("/admin/stories".concat(e?"?".concat(e):"")),getStoryForReview:e=>apiRequest("/admin/stories/".concat(e)),approveStory:e=>apiRequest("/admin/stories/".concat(e,"/approve"),{method:"PATCH"}),rejectStory:(e,t)=>apiRequest("/admin/stories/".concat(e,"/reject"),{method:"PATCH",body:JSON.stringify({reason:t})}),bulkApproveStories:e=>apiRequest("/admin/stories/bulk-approve",{method:"PATCH",body:JSON.stringify({storyIds:e})}),bulkRejectStories:(e,t)=>apiRequest("/admin/stories/bulk-reject",{method:"PATCH",body:JSON.stringify({storyIds:e,reason:t})}),getAllUsers:e=>apiRequest("/users/admin/all".concat(e?"?".concat(e):"")),suspendUser:(e,t,s)=>apiRequest("/admin/users/".concat(e,"/suspend"),{method:"PATCH",body:JSON.stringify({reason:t,duration:s})}),unsuspendUser:e=>apiRequest("/admin/users/".concat(e,"/unsuspend"),{method:"PATCH"}),deleteUser:e=>apiRequest("/users/".concat(e),{method:"DELETE"}),getAllAdmins:()=>apiRequest("/admin/admins"),getAdminProfile:()=>apiRequest("/admin/profile"),updateAdminProfile:e=>apiRequest("/admin/profile",{method:"PATCH",body:JSON.stringify(e)}),getAdminSettings:()=>apiRequest("/admin/settings"),updateAdminSettings:e=>apiRequest("/admin/settings",{method:"PATCH",body:JSON.stringify(e)}),getAnalytics:()=>apiRequest("/admin/analytics"),getDashboardStats:()=>apiRequest("/admin/dashboard-stats")}},96871:function(e,t,s){e.exports=s(92054)}},function(e){e.O(0,[2054,6895,7115,2835,1744],function(){return e(e.s=94008)}),_N_E=e.O()}]);