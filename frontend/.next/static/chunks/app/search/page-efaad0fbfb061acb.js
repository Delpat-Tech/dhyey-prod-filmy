(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2797],{90027:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]])},51843:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},44639:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},70423:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},57842:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]])},52183:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},5032:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},56634:function(e,t,s){Promise.resolve().then(s.bind(s,28472))},28472:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return SearchInterface}});var a=s(37821),r=s(58078),o=s(52183),i=s(5032),n=s(44639),c=s(45039),l=s.n(c),u=s(96871),d=s.n(u),h=s(51843),m=s(70423),p=s(57842),g=s(90027),f=s(86981);let y=[{id:1,title:"The Digital Nomad's Journey",author:{name:"Alex Thompson",username:"alexwrites",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face"},excerpt:"Working from coffee shops around the world taught me more than any office ever could...",image:"https://images.unsplash.com/photo-1521737604893-d14cc237f11d?w=300&h=200&fit=crop",genre:"Non-Fiction",likes:342,comments:28,saves:89,timeAgo:"3h",hashtags:["#travel","#work","#lifestyle"]},{id:2,title:"Midnight in Tokyo",author:{name:"Yuki Tanaka",username:"yukistories",avatar:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=40&h=40&fit=crop&crop=face"},excerpt:"The neon lights reflected off the wet streets as I walked through Shibuya, each step taking me further from my past...",image:"https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=300&h=200&fit=crop",genre:"Fiction",likes:567,comments:45,saves:123,timeAgo:"5h",hashtags:["#tokyo","#fiction","#urban"]},{id:3,title:"The Art of Letting Go",author:{name:"Maya Patel",username:"mayapoetry",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=40&h=40&fit=crop&crop=face"},excerpt:"Like autumn leaves that dance on wind, our memories float away, leaving space for new growth...",image:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=300&h=200&fit=crop",genre:"Poetry",likes:234,comments:19,saves:67,timeAgo:"1d",hashtags:["#poetry","#healing","#growth"]}];function SearchResults(e){let{query:t,searchType:s,genre:r,sortBy:i,results:n,isLoading:c,hasSearched:u}=e,x=n&&n.length>0?n:u&&n?[]:y,v=n?x:x.filter(e=>{var a,o,i;if("All"!==r&&e.genre!==r)return!1;if(!t)return!0;let n=t.toLowerCase();switch(s){case"title":return e.title.toLowerCase().includes(n);case"author":return e.author.name.toLowerCase().includes(n)||e.author.username.toLowerCase().includes(n);case"hashtag":return null===(a=e.hashtags)||void 0===a?void 0:a.some(e=>e.toLowerCase().includes(n));default:return e.title.toLowerCase().includes(n)||e.author.name.toLowerCase().includes(n)||(null===(o=e.hashtags)||void 0===o?void 0:o.some(e=>e.toLowerCase().includes(n)))||(null===(i=e.excerpt)||void 0===i?void 0:i.toLowerCase().includes(n))}});return c?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Searching..."})]}):t||"All"!==r||u?0===v.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(o.Z,{size:32,className:"text-gray-400"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Results Found"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Try adjusting your search terms or filters to find what you're looking for"})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[v.length," result",1!==v.length?"s":""," found",t&&' for "'.concat(t,'"')]})}),(0,a.jsx)("div",{className:"grid gap-4 md:gap-6",children:v.map(e=>(0,a.jsx)("div",{className:"bg-white rounded-xl border border-gray-100 overflow-hidden hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"md:flex",children:[(0,a.jsx)("div",{className:"md:w-48 h-48 md:h-auto relative flex-shrink-0",children:(0,a.jsx)(d(),{href:"/story/".concat(e._id||e.id),children:(0,a.jsx)(l(),{src:(0,f.Jn)(e.image),alt:e.title,fill:!0,className:"object-cover hover:scale-105 transition-transform duration-300"})})}),(0,a.jsxs)("div",{className:"flex-1 p-4 md:p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(d(),{href:"/profile/".concat(e.author.username),children:(0,a.jsx)(l(),{src:(0,f.E$)(e.author.avatar),alt:e.author.name,width:32,height:32,className:"rounded-full"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d(),{href:"/profile/".concat(e.author.username),className:"font-medium text-gray-900 hover:text-purple-600",children:e.author.name}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,a.jsxs)("span",{children:["@",e.author.username]}),(0,a.jsx)("span",{children:"â€¢"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(h.Z,{size:12}),(0,a.jsx)("span",{children:e.timeAgo})]})]})]})]}),(0,a.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-medium",children:e.genre})]}),(0,a.jsxs)(d(),{href:"/story/".concat(e._id||e.id),children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-gray-900 mb-2 hover:text-purple-600 transition-colors",children:e.title}),(0,a.jsx)("p",{className:"text-gray-700 mb-3 line-clamp-2",children:e.excerpt})]}),e.hashtags&&e.hashtags.length>0&&(0,a.jsx)("div",{className:"flex items-center space-x-1 mb-4",children:e.hashtags.map((e,t)=>(0,a.jsx)("span",{className:"text-purple-600 text-sm hover:underline cursor-pointer",children:e},t))}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(m.Z,{size:16}),(0,a.jsx)("span",{children:e.likes})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(p.Z,{size:16}),(0,a.jsx)("span",{children:e.comments})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(g.Z,{size:16}),(0,a.jsx)("span",{children:e.saves})]})]}),(0,a.jsx)(d(),{href:"/story/".concat(e.id),className:"text-purple-600 hover:text-purple-700 font-medium text-sm",children:"Read More"})]})]})]})},e._id||e.id))}),(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("button",{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white px-8 py-3 rounded-full font-medium hover:from-purple-600 hover:to-pink-600 transition-all",children:"Load More Results"})})]}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(o.Z,{size:32,className:"text-gray-400"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Start Your Discovery"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Search for stories, authors, or hashtags to find amazing content"})]})}var x=s(8494);let v=["All","Fiction","Poetry","Romance","Mystery","Sci-Fi","Fantasy","Drama"],b=["Latest","Most Liked","Most Saved","Trending"];function SearchInterface(){let[e,t]=(0,r.useState)(""),[s,c]=(0,r.useState)("All"),[l,u]=(0,r.useState)("Latest"),[d,h]=(0,r.useState)(!1),[m,p]=(0,r.useState)("all"),[g,f]=(0,r.useState)([]),[y,j]=(0,r.useState)(!1),[S,w]=(0,r.useState)(!1),performSearch=async e=>{if(!e.trim()){f([]),w(!1);return}j(!0),w(!0);try{let t=[],a=e,r={genre:"All"!==s?s:void 0,sortBy:l.toLowerCase().replace(" ","_")};"author"===m?r.author=e:"hashtag"===m&&(a=e.startsWith("#")?e:"#".concat(e)),console.log("Searching with query:",a,"type:",m,"filters:",r);let o=await x.OF.searchStories(a,r);console.log("Full search response:",o),t=o.stories||[],console.log("Found",t.length,"stories:",t),f(t)}catch(e){console.error("Search failed:",e),f([])}finally{j(!1)}},handleSearch=async t=>{t.preventDefault(),performSearch(e)};return(0,r.useEffect)(()=>{let t=setTimeout(()=>{e.length>=2?(console.log("Auto-searching for:",e),performSearch(e)):0===e.length&&(f([]),w(!1))},500);return()=>clearTimeout(t)},[e,m,s,l]),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("form",{onSubmit:handleSearch,className:"relative",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o.Z,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,a.jsx)("input",{type:"text",placeholder:"Search stories, authors, or hashtags...",value:e,onChange:e=>t(e.target.value),className:"w-full pl-12 pr-12 py-4 bg-white border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-lg text-gray-900"}),e&&(0,a.jsx)("button",{type:"button",onClick:()=>{t("")},className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(i.Z,{size:20})})]})}),(0,a.jsx)("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:[{key:"all",label:"All"},{key:"title",label:"Title"},{key:"author",label:"Author"},{key:"hashtag",label:"Hashtag"}].map(e=>{let{key:t,label:s}=e;return(0,a.jsx)("button",{onClick:()=>p(t),className:"px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors ".concat(m===t?"bg-purple-500 text-white":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-200"),children:s},t)})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("button",{onClick:()=>h(!d),className:"flex items-center space-x-2 px-4 py-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,a.jsx)(n.Z,{size:16}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Filters"})]}),"All"!==s&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm",children:[(0,a.jsx)("span",{children:s}),(0,a.jsx)("button",{onClick:()=>c("All"),children:(0,a.jsx)(i.Z,{size:14})})]})]}),(0,a.jsx)("select",{value:l,onChange:e=>u(e.target.value),className:"px-4 py-2 bg-white border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm text-gray-900",children:b.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),d&&(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6 space-y-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:"Filter by Genre"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:v.map(e=>(0,a.jsx)("button",{onClick:()=>c(e),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors ".concat(s===e?"bg-purple-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e},e))})]}),(0,a.jsx)(SearchResults,{query:e,searchType:m,genre:s,sortBy:l,results:g,isLoading:y,hasSearched:S})]})}},8494:function(e,t,s){"use strict";s.d(t,{OF:function(){return n},Sb:function(){return c},TV:function(){return o},fh:function(){return i},kv:function(){return r}});let a="https://api.dhyey.delpat.in/api/v1",apiRequest=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=localStorage.getItem("dhyey_token"),r=localStorage.getItem("dhyey_token_expiry");if(s&&r&&new Date().getTime()>parseInt(r))throw console.log("Token expired, clearing session"),localStorage.removeItem("dhyey_user"),localStorage.removeItem("dhyey_token"),localStorage.removeItem("dhyey_token_expiry"),localStorage.removeItem("dhyey_remember_me"),window.location.pathname.includes("/auth/")||(window.location.href="/auth/login"),Error("Session expired. Please log in again.");let o={...t,headers:{"Content-Type":"application/json",...s&&{Authorization:"Bearer ".concat(s)},...t.headers},...s&&{credentials:"include"}},i=await fetch("".concat(a).concat(e),o);if(401===i.status){if(e.includes("/auth/update-password")||e.includes("/auth/change-password")){let e=await i.json().catch(()=>({}));throw Error(e.message||"Current password is incorrect")}throw console.log("Unauthorized request, clearing session"),localStorage.removeItem("dhyey_user"),localStorage.removeItem("dhyey_token"),localStorage.removeItem("dhyey_token_expiry"),localStorage.removeItem("dhyey_remember_me"),window.location.pathname.includes("/auth/")||(window.location.href="/auth/login"),Error("Session expired. Please log in again.")}if(!i.ok){let e=await i.json().catch(()=>({}));throw Error(e.message||"HTTP error! status: ".concat(i.status))}return i.json()},r={login:(e,t)=>fetch("".concat(a,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(async e=>{if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.message||"HTTP error! status: ".concat(e.status))}return e.json()}),register:e=>fetch("".concat(a,"/auth/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(async e=>{let t=await e.json();if(!e.ok)throw Error(t.message||"HTTP error! status: ".concat(e.status));return t}),forgotPassword:e=>apiRequest("/auth/forgot-password",{method:"POST",body:JSON.stringify({email:e})}),resetPassword:(e,t,s)=>apiRequest("/auth/reset-password/".concat(e),{method:"PATCH",body:JSON.stringify({password:t,passwordConfirm:s})}),updatePassword:(e,t,s)=>apiRequest("/auth/update-password",{method:"PATCH",body:JSON.stringify({passwordCurrent:e,password:t,passwordConfirm:s})}),changePassword:(e,t,s)=>apiRequest("/auth/change-password",{method:"PATCH",body:JSON.stringify({passwordCurrent:e,password:t,passwordConfirm:s})}),logout:()=>apiRequest("/auth/logout",{method:"POST"}),refreshToken:()=>apiRequest("/auth/refresh-token",{method:"POST"})},o={getMe:()=>apiRequest("/users/me"),updateMe:e=>apiRequest("/users/me",{method:"PATCH",body:JSON.stringify(e)}),getUserProfile:e=>apiRequest("/users/profile/".concat(e)),followUser:e=>apiRequest("/users/".concat(e,"/follow"),{method:"POST"}),getUserFollowers:e=>apiRequest("/users/".concat(e,"/followers")),getUserFollowing:e=>apiRequest("/users/".concat(e,"/following")),getUserSavedStories:e=>apiRequest("/users/".concat(e,"/saved")),getUserLikedStories:()=>apiRequest("/users/me/liked"),getAllUsers:()=>apiRequest("/users/admin/all")},i={getPublicStories:e=>apiRequest("/stories".concat(e?"?".concat(e):"")),getStoryById:e=>apiRequest("/stories/".concat(e)),createStory:e=>apiRequest("/stories",{method:"POST",body:JSON.stringify(e)}),updateStory:(e,t)=>apiRequest("/stories/".concat(e),{method:"PATCH",body:JSON.stringify(t)}),deleteStory:e=>apiRequest("/stories/".concat(e),{method:"DELETE"}),likeStory:e=>apiRequest("/stories/".concat(e,"/like"),{method:"POST"}),saveStory:e=>apiRequest("/stories/".concat(e,"/save"),{method:"POST"}),shareStory:(e,t)=>apiRequest("/stories/".concat(e,"/share"),{method:"POST",body:JSON.stringify(t||{})}),getUserStories:e=>apiRequest("/stories/user/".concat(e)),searchStories:(e,t)=>{let s=new URLSearchParams({q:e,...t});return apiRequest("/stories/search?".concat(s))},getStoryComments:e=>apiRequest("/stories/".concat(e,"/comments")),addComment:(e,t,s)=>apiRequest("/stories/".concat(e,"/comments"),{method:"POST",body:JSON.stringify({content:t,parentComment:s})}),likeComment:(e,t)=>apiRequest("/stories/".concat(e,"/comments/").concat(t,"/like"),{method:"POST"})},n={searchStories:(e,t)=>{let s=t?Object.fromEntries(Object.entries(t).filter(e=>{let[t,s]=e;return null!=s&&""!==s})):{},a=new URLSearchParams({q:e,...s});return console.log("API call URL:","/search/stories?".concat(a)),apiRequest("/search/stories?".concat(a))},searchUsers:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/users?".concat(t))},getSearchSuggestions:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/suggestions?".concat(t))},getSearchFilters:()=>apiRequest("/search/filters"),globalSearch:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/global?".concat(t))}},c={getAllStories:e=>apiRequest("/admin/stories".concat(e?"?".concat(e):"")),getStoryForReview:e=>apiRequest("/admin/stories/".concat(e)),approveStory:e=>apiRequest("/admin/stories/".concat(e,"/approve"),{method:"PATCH"}),rejectStory:(e,t)=>apiRequest("/admin/stories/".concat(e,"/reject"),{method:"PATCH",body:JSON.stringify({reason:t})}),bulkApproveStories:e=>apiRequest("/admin/stories/bulk-approve",{method:"PATCH",body:JSON.stringify({storyIds:e})}),bulkRejectStories:(e,t)=>apiRequest("/admin/stories/bulk-reject",{method:"PATCH",body:JSON.stringify({storyIds:e,reason:t})}),getAllUsers:e=>apiRequest("/users/admin/all".concat(e?"?".concat(e):"")),suspendUser:(e,t,s)=>apiRequest("/admin/users/".concat(e,"/suspend"),{method:"PATCH",body:JSON.stringify({reason:t,duration:s})}),unsuspendUser:e=>apiRequest("/admin/users/".concat(e,"/unsuspend"),{method:"PATCH"}),deleteUser:e=>apiRequest("/users/".concat(e),{method:"DELETE"}),getAllAdmins:()=>apiRequest("/admin/admins"),getAdminProfile:()=>apiRequest("/admin/profile"),updateAdminProfile:e=>apiRequest("/admin/profile",{method:"PATCH",body:JSON.stringify(e)}),getAdminSettings:()=>apiRequest("/admin/settings"),updateAdminSettings:e=>apiRequest("/admin/settings",{method:"PATCH",body:JSON.stringify(e)}),getAnalytics:()=>apiRequest("/admin/analytics"),getDashboardStats:()=>apiRequest("/admin/dashboard-stats")}},86981:function(e,t,s){"use strict";s.d(t,{E$:function(){return getAvatarUrl},Jn:function(){return getImageUrl}});let getImageUrl=(e,t)=>{if(!e)return t||"https://ui-avatars.com/api/?name=User&background=6366f1&color=fff&size=150";if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("blob:"))return e;let s=e.startsWith("/")?e:"/".concat(e);return"".concat("https://api.dhyey.delpat.in/api/v1").concat(s)},getAvatarUrl=e=>getImageUrl(e,"https://ui-avatars.com/api/?name=User&background=6366f1&color=fff&size=150")},96871:function(e,t,s){e.exports=s(92054)}},function(e){e.O(0,[2054,6895,7115,2835,1744],function(){return e(e.s=56634)}),_N_E=e.O()}]);