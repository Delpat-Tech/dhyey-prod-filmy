(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7801],{57068:function(e,t,s){"use strict";s.d(t,{Z:function(){return createLucideIcon}});var r=s(58078),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),createLucideIcon=(e,t)=>{let s=(0,r.forwardRef)(({color:s="currentColor",size:o=24,strokeWidth:n=2,absoluteStrokeWidth:i,children:c,...d},l)=>(0,r.createElement)("svg",{ref:l,...a,width:o,height:o,stroke:s,strokeWidth:i?24*Number(n)/Number(o):n,className:`lucide lucide-${toKebabCase(e)}`,...d},[...t.map(([e,t])=>(0,r.createElement)(e,t)),...(Array.isArray(c)?c:[c])||[]]));return s.displayName=`${e}`,s}},25498:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},81238:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},52080:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},58643:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},10776:function(e,t,s){Promise.resolve().then(s.bind(s,43897))},43897:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return AdminChangePasswordPage}});var r=s(37821),a=s(96871),o=s.n(a),n=s(25498),i=s(46179),c=s(58078),d=s(58643),l=s(81238),u=s(52080),m=s(8494);function AdminChangePasswordForm(e){let{onSuccess:t,onCancel:s}=e,[a,o]=(0,c.useState)({passwordCurrent:"",password:"",passwordConfirm:""}),[n,i]=(0,c.useState)({current:!1,new:!1,confirm:!1}),[p,h]=(0,c.useState)(!1),[g,y]=(0,c.useState)(""),[f,w]=(0,c.useState)(""),handleSubmit=async e=>{if(e.preventDefault(),y(""),w(""),a.password!==a.passwordConfirm){y("New passwords do not match");return}if(a.password.length<8){y("New password must be at least 8 characters long");return}h(!0);try{await m.kv.changePassword(a.passwordCurrent,a.password,a.passwordConfirm),w("Admin password changed successfully!"),o({passwordCurrent:"",password:"",passwordConfirm:""}),null==t||t()}catch(e){y(e.message||"Failed to change password")}finally{h(!1)}},togglePasswordVisibility=e=>{i(t=>({...t,[e]:!t[e]}))};return(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,r.jsx)(d.Z,{size:20,className:"text-gray-600"}),(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Change Admin Password"})]}),g&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,r.jsx)("p",{className:"text-sm text-red-600",children:g})}),f&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-md",children:(0,r.jsx)("p",{className:"text-sm text-green-600",children:f})}),(0,r.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:n.current?"text":"password",value:a.passwordCurrent,onChange:e=>o({...a,passwordCurrent:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent pr-10 bg-white",required:!0}),(0,r.jsx)("button",{type:"button",onClick:()=>togglePasswordVisibility("current"),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:n.current?(0,r.jsx)(l.Z,{size:16,className:"text-gray-400"}):(0,r.jsx)(u.Z,{size:16,className:"text-gray-400"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:n.new?"text":"password",value:a.password,onChange:e=>o({...a,password:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent pr-10 bg-white",minLength:8,required:!0}),(0,r.jsx)("button",{type:"button",onClick:()=>togglePasswordVisibility("new"),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:n.new?(0,r.jsx)(l.Z,{size:16,className:"text-gray-400"}):(0,r.jsx)(u.Z,{size:16,className:"text-gray-400"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:n.confirm?"text":"password",value:a.passwordConfirm,onChange:e=>o({...a,passwordConfirm:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent pr-10 bg-white",required:!0}),(0,r.jsx)("button",{type:"button",onClick:()=>togglePasswordVisibility("confirm"),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:n.confirm?(0,r.jsx)(l.Z,{size:16,className:"text-gray-400"}):(0,r.jsx)(u.Z,{size:16,className:"text-gray-400"})})]})]}),(0,r.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,r.jsx)("button",{type:"submit",disabled:p,className:"flex-1 bg-purple-600 text-white py-2 px-4 rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Changing...":"Change Password"}),s&&(0,r.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Cancel"})]})]})]})}function AdminChangePasswordPage(){let e=(0,i.useRouter)();return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-md mx-auto pt-8",children:[(0,r.jsx)("div",{className:"bg-white border-b border-gray-200 px-4 py-4 rounded-t-lg",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(o(),{href:"/admin/settings",className:"text-gray-600 hover:text-gray-900",children:(0,r.jsx)(n.Z,{size:20})}),(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Change Admin Password"})]})}),(0,r.jsx)("div",{className:"bg-white rounded-b-lg border-l border-r border-b border-gray-200",children:(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)(AdminChangePasswordForm,{onSuccess:()=>{setTimeout(()=>{e.push("/admin/settings")},2e3)},onCancel:()=>{e.push("/admin/settings")}})})})]})})}},8494:function(e,t,s){"use strict";s.d(t,{OF:function(){return i},Sb:function(){return c},TV:function(){return o},fh:function(){return n},kv:function(){return a}});let r="https://api.dhyey.delpat.in/api/v1",apiRequest=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=localStorage.getItem("dhyey_token"),a=localStorage.getItem("dhyey_token_expiry");if(s&&a&&new Date().getTime()>parseInt(a))throw console.log("Token expired, clearing session"),localStorage.removeItem("dhyey_user"),localStorage.removeItem("dhyey_token"),localStorage.removeItem("dhyey_token_expiry"),localStorage.removeItem("dhyey_remember_me"),window.location.pathname.includes("/auth/")||(window.location.href="/auth/login"),Error("Session expired. Please log in again.");let o={...t,headers:{"Content-Type":"application/json",...s&&{Authorization:"Bearer ".concat(s)},...t.headers},...s&&{credentials:"include"}},n=await fetch("".concat(r).concat(e),o);if(401===n.status){if(e.includes("/auth/update-password")||e.includes("/auth/change-password")){let e=await n.json().catch(()=>({}));throw Error(e.message||"Current password is incorrect")}throw console.log("Unauthorized request, clearing session"),localStorage.removeItem("dhyey_user"),localStorage.removeItem("dhyey_token"),localStorage.removeItem("dhyey_token_expiry"),localStorage.removeItem("dhyey_remember_me"),window.location.pathname.includes("/auth/")||(window.location.href="/auth/login"),Error("Session expired. Please log in again.")}if(!n.ok){let e=await n.json().catch(()=>({}));throw Error(e.message||"HTTP error! status: ".concat(n.status))}return n.json()},a={login:(e,t)=>fetch("".concat(r,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(async e=>{if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.message||"HTTP error! status: ".concat(e.status))}return e.json()}),register:e=>fetch("".concat(r,"/auth/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(async e=>{let t=await e.json();if(!e.ok)throw Error(t.message||"HTTP error! status: ".concat(e.status));return t}),forgotPassword:e=>apiRequest("/auth/forgot-password",{method:"POST",body:JSON.stringify({email:e})}),resetPassword:(e,t,s)=>apiRequest("/auth/reset-password/".concat(e),{method:"PATCH",body:JSON.stringify({password:t,passwordConfirm:s})}),updatePassword:(e,t,s)=>apiRequest("/auth/update-password",{method:"PATCH",body:JSON.stringify({passwordCurrent:e,password:t,passwordConfirm:s})}),changePassword:(e,t,s)=>apiRequest("/auth/change-password",{method:"PATCH",body:JSON.stringify({passwordCurrent:e,password:t,passwordConfirm:s})}),logout:()=>apiRequest("/auth/logout",{method:"POST"}),refreshToken:()=>apiRequest("/auth/refresh-token",{method:"POST"})},o={getMe:()=>apiRequest("/users/me"),updateMe:e=>apiRequest("/users/me",{method:"PATCH",body:JSON.stringify(e)}),getUserProfile:e=>apiRequest("/users/profile/".concat(e)),followUser:e=>apiRequest("/users/".concat(e,"/follow"),{method:"POST"}),getUserFollowers:e=>apiRequest("/users/".concat(e,"/followers")),getUserFollowing:e=>apiRequest("/users/".concat(e,"/following")),getUserSavedStories:e=>apiRequest("/users/".concat(e,"/saved")),getUserLikedStories:()=>apiRequest("/users/me/liked"),getAllUsers:()=>apiRequest("/users/admin/all")},n={getPublicStories:e=>apiRequest("/stories".concat(e?"?".concat(e):"")),getStoryById:e=>apiRequest("/stories/".concat(e)),createStory:e=>apiRequest("/stories",{method:"POST",body:JSON.stringify(e)}),updateStory:(e,t)=>apiRequest("/stories/".concat(e),{method:"PATCH",body:JSON.stringify(t)}),deleteStory:e=>apiRequest("/stories/".concat(e),{method:"DELETE"}),likeStory:e=>apiRequest("/stories/".concat(e,"/like"),{method:"POST"}),saveStory:e=>apiRequest("/stories/".concat(e,"/save"),{method:"POST"}),shareStory:(e,t)=>apiRequest("/stories/".concat(e,"/share"),{method:"POST",body:JSON.stringify(t||{})}),getUserStories:e=>apiRequest("/stories/user/".concat(e)),searchStories:(e,t)=>{let s=new URLSearchParams({q:e,...t});return apiRequest("/stories/search?".concat(s))},getStoryComments:e=>apiRequest("/stories/".concat(e,"/comments")),addComment:(e,t,s)=>apiRequest("/stories/".concat(e,"/comments"),{method:"POST",body:JSON.stringify({content:t,parentComment:s})}),likeComment:(e,t)=>apiRequest("/stories/".concat(e,"/comments/").concat(t,"/like"),{method:"POST"})},i={searchStories:(e,t)=>{let s=t?Object.fromEntries(Object.entries(t).filter(e=>{let[t,s]=e;return null!=s&&""!==s})):{},r=new URLSearchParams({q:e,...s});return console.log("API call URL:","/search/stories?".concat(r)),apiRequest("/search/stories?".concat(r))},searchUsers:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/users?".concat(t))},getSearchSuggestions:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/suggestions?".concat(t))},getSearchFilters:()=>apiRequest("/search/filters"),globalSearch:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/global?".concat(t))}},c={getAllStories:e=>apiRequest("/admin/stories".concat(e?"?".concat(e):"")),getStoryForReview:e=>apiRequest("/admin/stories/".concat(e)),approveStory:e=>apiRequest("/admin/stories/".concat(e,"/approve"),{method:"PATCH"}),rejectStory:(e,t)=>apiRequest("/admin/stories/".concat(e,"/reject"),{method:"PATCH",body:JSON.stringify({reason:t})}),bulkApproveStories:e=>apiRequest("/admin/stories/bulk-approve",{method:"PATCH",body:JSON.stringify({storyIds:e})}),bulkRejectStories:(e,t)=>apiRequest("/admin/stories/bulk-reject",{method:"PATCH",body:JSON.stringify({storyIds:e,reason:t})}),getAllUsers:e=>apiRequest("/users/admin/all".concat(e?"?".concat(e):"")),suspendUser:(e,t,s)=>apiRequest("/admin/users/".concat(e,"/suspend"),{method:"PATCH",body:JSON.stringify({reason:t,duration:s})}),unsuspendUser:e=>apiRequest("/admin/users/".concat(e,"/unsuspend"),{method:"PATCH"}),deleteUser:e=>apiRequest("/users/".concat(e),{method:"DELETE"}),getAllAdmins:()=>apiRequest("/admin/admins"),getAdminProfile:()=>apiRequest("/admin/profile"),updateAdminProfile:e=>apiRequest("/admin/profile",{method:"PATCH",body:JSON.stringify(e)}),getAdminSettings:()=>apiRequest("/admin/settings"),updateAdminSettings:e=>apiRequest("/admin/settings",{method:"PATCH",body:JSON.stringify(e)}),getAnalytics:()=>apiRequest("/admin/analytics"),getDashboardStats:()=>apiRequest("/admin/dashboard-stats")}},8489:function(e,t,s){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=s(58078),a=Symbol.for("react.element"),o=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,s){var r,o={},d=null,l=null;for(r in void 0!==s&&(d=""+s),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(l=t.ref),t)n.call(t,r)&&!c.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:a,type:e,key:d,ref:l,props:o,_owner:i.current}}t.Fragment=o,t.jsx=q,t.jsxs=q},37821:function(e,t,s){"use strict";e.exports=s(8489)},96871:function(e,t,s){e.exports=s(92054)},46179:function(e,t,s){e.exports=s(85353)}},function(e){e.O(0,[2054,7115,2835,1744],function(){return e(e.s=10776)}),_N_E=e.O()}]);