(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9674],{81682:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]])},6026:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},775:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},11654:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},52080:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},7672:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},52183:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},71607:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},25861:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]])},94620:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]])},36570:function(e,t,s){Promise.resolve().then(s.bind(s,83257))},83257:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return UserManagement}});var r=s(37821),a=s(58078),n=s(96871),o=s.n(n),i=s(45039),l=s.n(i),c=s(71607),d=s(25861),u=s(6026),h=s(81682),m=s(52183),p=s(52080),g=s(7672),x=s(94620);let y=(0,a.forwardRef)((e,t)=>{let{checked:s=!1,onChange:a,disabled:n=!1,size:o="md",className:i="",id:l,name:c,value:d,indeterminate:u=!1,...h}=e;return(0,r.jsxs)("div",{className:"relative inline-flex items-center ".concat(i),children:[(0,r.jsx)("input",{ref:t,type:"checkbox",id:l,name:c,value:d,checked:s,onChange:e=>{a&&a(e.target.checked)},disabled:n,className:"\n            ".concat({sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"}[o],"\n            appearance-none\n            border-2\n            rounded-md\n            cursor-pointer\n            transition-all\n            duration-200\n            ease-in-out\n            focus:outline-none\n            focus:ring-2\n            focus:ring-purple-500\n            focus:ring-offset-2\n            ").concat(s?"bg-gradient-to-br from-purple-600 to-indigo-600 border-purple-600 shadow-sm":"bg-white border-gray-300 hover:border-purple-400","\n            ").concat(n?"opacity-50 cursor-not-allowed":"hover:shadow-md","\n            ").concat(u?"bg-gradient-to-br from-purple-600 to-indigo-600 border-purple-600":"","\n          "),...h}),s&&!u&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,r.jsx)("svg",{className:"text-white ".concat("sm"===o?"w-3 h-3":"md"===o?"w-4 h-4":"w-5 h-5"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),u&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,r.jsx)("div",{className:"bg-white rounded-sm ".concat("sm"===o?"w-2 h-0.5":"md"===o?"w-2.5 h-0.5":"w-3 h-0.5")})}),!n&&!s&&(0,r.jsx)("div",{className:"absolute inset-0 rounded-md bg-purple-50 opacity-0 hover:opacity-20 transition-opacity duration-200 pointer-events-none"})]})});y.displayName="Checkbox";var f=s(49913),b=s(8494),v=s(88742);let w={active:"bg-green-100 text-green-800",suspended:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800"};function UserManagement(){let[e,t]=(0,a.useState)(""),[s,n]=(0,a.useState)("all"),[i,j]=(0,a.useState)("all"),[S,N]=(0,a.useState)([]),[k,C]=(0,a.useState)(!1),[R,A]=(0,a.useState)(null),[q,U]=(0,a.useState)([]),[P,T]=(0,a.useState)(!0),[O,Z]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let loadUsers=async()=>{try{T(!0);let t=new URLSearchParams;"all"!==s&&t.append("status",s),"all"!==i&&t.append("role",i),e&&t.append("search",e);let r=await b.Sb.getAllUsers(t);U(r.data.users||[])}catch(e){console.error("Failed to load users:",e),U([]),(0,v.c0)({type:"error",title:"Failed to load users",message:"Please check your connection and try again."})}finally{T(!1)}};loadUsers()},[s,i,e]);let E=q.filter(t=>{let r=(t.name||"").toLowerCase().includes(e.toLowerCase())||(t.username||"").toLowerCase().includes(e.toLowerCase())||(t.email||"").toLowerCase().includes(e.toLowerCase()),a="all"===s||t.status===s,n="all"===i||t.role===i;return r&&a&&n}),handleSelectUser=e=>{N(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},handleSelectAll=()=>{N(S.length===E.length?[]:E.map(e=>e.id.toString()))},handleBulkAction=e=>{A(e),C(!0)},confirmBulkAction=async()=>{if(0!==S.length&&R){Z(!0);try{for(let e of S)"suspend"===R?await b.Sb.suspendUser(e,"Bulk suspension by admin"):"activate"===R?await b.Sb.unsuspendUser(e):"delete"===R&&await b.Sb.deleteUser(e);(0,v.c0)({type:"success",title:"Action Completed",message:"".concat(S.length," users have been ").concat(R,"d.")});let t=new URLSearchParams;"all"!==s&&t.append("status",s),"all"!==i&&t.append("role",i),e&&t.append("search",e);let r=await b.Sb.getAllUsers(t);U(r.data.users||[])}catch(e){(0,v.c0)({type:"error",title:"Action Failed",message:"Failed to ".concat(R," users. Please try again.")})}finally{Z(!1),C(!1),A(null),N([])}}},handleSingleUserAction=async(t,r)=>{Z(!0);try{"suspend"===r?(await b.Sb.suspendUser(t,"Suspended by admin"),(0,v.c0)({type:"success",title:"User Suspended",message:"The user has been suspended."})):"activate"===r?(await b.Sb.unsuspendUser(t),(0,v.c0)({type:"success",title:"User Activated",message:"The user has been activated."})):"delete"===r&&(await b.Sb.deleteUser(t),(0,v.c0)({type:"success",title:"User Deleted",message:"The user has been deleted."}));let a=new URLSearchParams;"all"!==s&&a.append("status",s),"all"!==i&&a.append("role",i),e&&a.append("search",e);let n=await b.Sb.getAllUsers(a);U(n.data.users||[])}catch(e){(0,v.c0)({type:"error",title:"Action Failed",message:"Failed to ".concat(r," user. Please try again.")})}finally{Z(!1)}},formatDate=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),formatLastActive=e=>{let t=new Date,s=new Date(e),r=Math.floor((t.getTime()-s.getTime())/36e5);if(r<1)return"Just now";if(r<24)return"".concat(r,"h ago");let a=Math.floor(r/24);return a<7?"".concat(a,"d ago"):formatDate(e)};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Manage platform users and their permissions"})]}),(0,r.jsx)("div",{className:"mt-4 sm:mt-0",children:(0,r.jsxs)(o(),{href:"/admin/admins",className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg text-sm font-medium hover:bg-purple-700",children:[(0,r.jsx)(c.Z,{size:16}),(0,r.jsx)("span",{children:"Manage Admins"})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:q.length})]}),(0,r.jsx)(d.Z,{className:"h-8 w-8 text-blue-600"})]})}),(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Users"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:q.filter(e=>"active"===e.status).length})]}),(0,r.jsx)(u.Z,{className:"h-8 w-8 text-green-600"})]})}),(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Suspended"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:q.filter(e=>"suspended"===e.status).length})]}),(0,r.jsx)(h.Z,{className:"h-8 w-8 text-red-600"})]})})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(m.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),(0,r.jsx)("input",{type:"text",placeholder:"Search users...",value:e,onChange:e=>t(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 bg-white"})]}),(0,r.jsx)(f.Z,{value:s,onChange:e=>n(e),options:[{label:"All Status",value:"all"},{label:"Active",value:"active",emoji:"✅"},{label:"Suspended",value:"suspended",emoji:"⛔"}]}),(0,r.jsx)(f.Z,{value:i,onChange:e=>j(e),options:[{label:"All Roles",value:"all"},{label:"User",value:"user",emoji:"\uD83D\uDC64"},{label:"Admin",value:"admin",emoji:"\uD83D\uDC51"}]})]})}),S.length>0&&(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-sm font-medium text-blue-900",children:[S.length," user(s) selected"]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>handleBulkAction("activate"),className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700",children:"Activate"}),(0,r.jsx)("button",{onClick:()=>handleBulkAction("suspend"),className:"px-3 py-1 bg-yellow-600 text-white rounded text-sm hover:bg-yellow-700",children:"Suspend"}),(0,r.jsx)("button",{onClick:()=>handleBulkAction("delete"),className:"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:"Delete"}),(0,r.jsx)("button",{onClick:()=>N([]),className:"px-3 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700",children:"Clear"})]})]})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(y,{checked:S.length===E.length&&E.length>0,onChange:()=>handleSelectAll(),size:"md",className:"mr-3"}),(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["Users (",E.length,")"]})]})}),(0,r.jsx)("div",{className:"divide-y divide-gray-200",children:E.map(e=>{var t,s,a,n;return(0,r.jsx)("div",{className:"p-6 hover:bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(y,{checked:S.includes(e.id),onChange:()=>handleSelectUser(e.id),size:"md"}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(l(),{src:e.avatar,alt:e.name,width:48,height:48,className:"rounded-full"}),e.verified&&(0,r.jsx)(u.Z,{className:"absolute -bottom-1 -right-1 h-4 w-4 text-blue-500 bg-white rounded-full"})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,r.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(w[e.status]||w.active),children:e.status}),e.reportCount>0&&(0,r.jsxs)("span",{className:"px-2 py-1 bg-red-100 text-red-600 rounded text-xs font-medium",children:[e.reportCount," report(s)"]})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["@",e.username," • ",e.email]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:[e.location," • Joined ",formatDate(e.joinDate)]})]}),(0,r.jsxs)("div",{className:"hidden md:flex items-center space-x-6 text-sm text-gray-500",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:(null===(t=e.stats)||void 0===t?void 0:t.storiesCount)||(null===(s=e.stats)||void 0===s?void 0:s.stories)||0}),(0,r.jsx)("div",{children:"Stories"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:(null===(a=e.stats)||void 0===a?void 0:a.followersCount)||(null===(n=e.stats)||void 0===n?void 0:n.followers)||0}),(0,r.jsx)("div",{children:"Followers"})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["Last active: ",formatLastActive(e.lastActive)]}),(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 mt-2",children:[(0,r.jsx)("button",{className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded",title:"View Profile",children:(0,r.jsx)(p.Z,{size:16})}),(0,r.jsx)("button",{className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded",title:"Send Message",children:(0,r.jsx)(g.Z,{size:16})}),"admin@dhyey.com"!==e.email&&(0,r.jsx)("button",{onClick:()=>handleSingleUserAction(e.id,"suspended"===e.status?"activate":"suspend"),className:"p-1 rounded ".concat("suspended"===e.status?"text-green-400 hover:text-green-600 hover:bg-green-50":"text-red-400 hover:text-red-600 hover:bg-red-50"),title:"suspended"===e.status?"Unsuspend User":"Suspend User",disabled:O,children:(0,r.jsx)(x.Z,{size:16})})]})]})]})]})},e.id)})})]}),k&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Confirm ",null==R?void 0:R.charAt(0).toUpperCase(),null==R?void 0:R.slice(1)," Action"]}),(0,r.jsxs)("p",{className:"text-gray-600 mb-4",children:["Are you sure you want to ",R," ",S.length," selected user(s)? This action cannot be undone."]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>C(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,r.jsxs)("button",{onClick:confirmBulkAction,className:"px-4 py-2 rounded-lg text-white ".concat("delete"===R?"bg-red-600 hover:bg-red-700":"suspend"===R?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"),children:[null==R?void 0:R.charAt(0).toUpperCase(),null==R?void 0:R.slice(1)," Users"]})]})]})})]})}},49913:function(e,t,s){"use strict";s.d(t,{Z:function(){return CustomSelect}});var r=s(37821),a=s(58078),n=s(11654),o=s(775);function CustomSelect(e){let{options:t,value:s,defaultValue:i,placeholder:l="Select an option",mode:c="single",style:d,className:u="",onChange:h,disabled:m=!1,optionRender:p}=e,[g,x]=(0,a.useState)(!1),[y,f]=(0,a.useState)(()=>void 0!==s?Array.isArray(s)?s:[s]:void 0!==i?Array.isArray(i)?i:[i]:[]),b=(0,a.useRef)(null);(0,a.useEffect)(()=>{void 0!==s&&f(Array.isArray(s)?s:[s])},[s]),(0,a.useEffect)(()=>{let handleClickOutside=e=>{b.current&&!b.current.contains(e.target)&&x(!1)};return document.addEventListener("mousedown",handleClickOutside),()=>document.removeEventListener("mousedown",handleClickOutside)},[]);let handleOptionClick=e=>{let t;"multiple"===c?t=y.includes(e)?y.filter(t=>t!==e):[...y,e]:(t=[e],x(!1)),f(t),h&&h("multiple"===c?t:t[0]||"")},renderOption=e=>p?p(e):(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[e.emoji&&(0,r.jsx)("span",{role:"img","aria-label":e.label,children:e.emoji}),(0,r.jsx)("span",{children:e.desc||e.label})]});return(0,r.jsxs)("div",{ref:b,className:"relative ".concat(u),style:d,children:[(0,r.jsxs)("button",{type:"button",onClick:()=>!m&&x(!g),disabled:m,className:"\n          w-full px-3 py-2 text-left bg-white border border-gray-300 rounded-lg\n          focus:ring-2 focus:ring-purple-500 focus:border-transparent\n          flex items-center justify-between\n          ".concat(m?"bg-gray-100 cursor-not-allowed text-gray-500":"hover:border-gray-400 cursor-pointer","\n          ").concat(0===y.length?"text-gray-500":"text-gray-900","\n        "),children:[(0,r.jsx)("span",{className:"truncate",children:(()=>{if(0===y.length)return l;if("single"===c){let e=t.find(e=>e.value===y[0]);return(null==e?void 0:e.label)||y[0]}if(1===y.length){let e=t.find(e=>e.value===y[0]);return(null==e?void 0:e.label)||y[0]}return"".concat(y.length," items selected")})()}),(0,r.jsx)(n.Z,{size:16,className:"text-gray-400 transition-transform ".concat(g?"rotate-180":"")})]}),g&&!m&&(0,r.jsxs)("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-auto",children:[t.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>!e.disabled&&handleOptionClick(e.value),disabled:e.disabled,className:"\n                w-full px-3 py-2 text-left hover:bg-gray-50 transition-colors\n                flex items-center justify-between\n                ".concat(e.disabled?"text-gray-400 cursor-not-allowed":"text-gray-700","\n                ").concat(y.includes(e.value)?"bg-purple-50 text-purple-700":"","\n              "),children:[(0,r.jsx)("div",{className:"flex-1",children:renderOption(e)}),y.includes(e.value)&&(0,r.jsx)(o.Z,{size:16,className:"text-purple-600 ml-2"})]},e.value)),0===t.length&&(0,r.jsx)("div",{className:"px-3 py-2 text-gray-500 text-center",children:"No options available"})]})]})}},8494:function(e,t,s){"use strict";s.d(t,{OF:function(){return i},Sb:function(){return l},TV:function(){return n},fh:function(){return o},kv:function(){return a}});let r="https://api.dhyey.delpat.in/api/v1",apiRequest=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=localStorage.getItem("dhyey_token"),a=localStorage.getItem("dhyey_token_expiry");if(s&&a&&new Date().getTime()>parseInt(a))throw console.log("Token expired, clearing session"),localStorage.removeItem("dhyey_user"),localStorage.removeItem("dhyey_token"),localStorage.removeItem("dhyey_token_expiry"),localStorage.removeItem("dhyey_remember_me"),window.location.pathname.includes("/auth/")||(window.location.href="/auth/login"),Error("Session expired. Please log in again.");let n={...t,headers:{"Content-Type":"application/json",...s&&{Authorization:"Bearer ".concat(s)},...t.headers},...s&&{credentials:"include"}},o=await fetch("".concat(r).concat(e),n);if(401===o.status){if(e.includes("/auth/update-password")||e.includes("/auth/change-password")){let e=await o.json().catch(()=>({}));throw Error(e.message||"Current password is incorrect")}throw console.log("Unauthorized request, clearing session"),localStorage.removeItem("dhyey_user"),localStorage.removeItem("dhyey_token"),localStorage.removeItem("dhyey_token_expiry"),localStorage.removeItem("dhyey_remember_me"),window.location.pathname.includes("/auth/")||(window.location.href="/auth/login"),Error("Session expired. Please log in again.")}if(!o.ok){let e=await o.json().catch(()=>({}));throw Error(e.message||"HTTP error! status: ".concat(o.status))}return o.json()},a={login:(e,t)=>fetch("".concat(r,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(async e=>{if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.message||"HTTP error! status: ".concat(e.status))}return e.json()}),register:e=>fetch("".concat(r,"/auth/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(async e=>{let t=await e.json();if(!e.ok)throw Error(t.message||"HTTP error! status: ".concat(e.status));return t}),forgotPassword:e=>apiRequest("/auth/forgot-password",{method:"POST",body:JSON.stringify({email:e})}),resetPassword:(e,t,s)=>apiRequest("/auth/reset-password/".concat(e),{method:"PATCH",body:JSON.stringify({password:t,passwordConfirm:s})}),updatePassword:(e,t,s)=>apiRequest("/auth/update-password",{method:"PATCH",body:JSON.stringify({passwordCurrent:e,password:t,passwordConfirm:s})}),changePassword:(e,t,s)=>apiRequest("/auth/change-password",{method:"PATCH",body:JSON.stringify({passwordCurrent:e,password:t,passwordConfirm:s})}),logout:()=>apiRequest("/auth/logout",{method:"POST"}),refreshToken:()=>apiRequest("/auth/refresh-token",{method:"POST"})},n={getMe:()=>apiRequest("/users/me"),updateMe:e=>apiRequest("/users/me",{method:"PATCH",body:JSON.stringify(e)}),getUserProfile:e=>apiRequest("/users/profile/".concat(e)),followUser:e=>apiRequest("/users/".concat(e,"/follow"),{method:"POST"}),getUserFollowers:e=>apiRequest("/users/".concat(e,"/followers")),getUserFollowing:e=>apiRequest("/users/".concat(e,"/following")),getUserSavedStories:e=>apiRequest("/users/".concat(e,"/saved")),getUserLikedStories:()=>apiRequest("/users/me/liked"),getAllUsers:()=>apiRequest("/users/admin/all")},o={getPublicStories:e=>apiRequest("/stories".concat(e?"?".concat(e):"")),getStoryById:e=>apiRequest("/stories/".concat(e)),createStory:e=>apiRequest("/stories",{method:"POST",body:JSON.stringify(e)}),updateStory:(e,t)=>apiRequest("/stories/".concat(e),{method:"PATCH",body:JSON.stringify(t)}),deleteStory:e=>apiRequest("/stories/".concat(e),{method:"DELETE"}),likeStory:e=>apiRequest("/stories/".concat(e,"/like"),{method:"POST"}),saveStory:e=>apiRequest("/stories/".concat(e,"/save"),{method:"POST"}),shareStory:(e,t)=>apiRequest("/stories/".concat(e,"/share"),{method:"POST",body:JSON.stringify(t||{})}),getUserStories:e=>apiRequest("/stories/user/".concat(e)),searchStories:(e,t)=>{let s=new URLSearchParams({q:e,...t});return apiRequest("/stories/search?".concat(s))},getStoryComments:e=>apiRequest("/stories/".concat(e,"/comments")),addComment:(e,t,s)=>apiRequest("/stories/".concat(e,"/comments"),{method:"POST",body:JSON.stringify({content:t,parentComment:s})}),likeComment:(e,t)=>apiRequest("/stories/".concat(e,"/comments/").concat(t,"/like"),{method:"POST"})},i={searchStories:(e,t)=>{let s=t?Object.fromEntries(Object.entries(t).filter(e=>{let[t,s]=e;return null!=s&&""!==s})):{},r=new URLSearchParams({q:e,...s});return console.log("API call URL:","/search/stories?".concat(r)),apiRequest("/search/stories?".concat(r))},searchUsers:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/users?".concat(t))},getSearchSuggestions:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/suggestions?".concat(t))},getSearchFilters:()=>apiRequest("/search/filters"),globalSearch:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/global?".concat(t))}},l={getAllStories:e=>apiRequest("/admin/stories".concat(e?"?".concat(e):"")),getStoryForReview:e=>apiRequest("/admin/stories/".concat(e)),approveStory:e=>apiRequest("/admin/stories/".concat(e,"/approve"),{method:"PATCH"}),rejectStory:(e,t)=>apiRequest("/admin/stories/".concat(e,"/reject"),{method:"PATCH",body:JSON.stringify({reason:t})}),bulkApproveStories:e=>apiRequest("/admin/stories/bulk-approve",{method:"PATCH",body:JSON.stringify({storyIds:e})}),bulkRejectStories:(e,t)=>apiRequest("/admin/stories/bulk-reject",{method:"PATCH",body:JSON.stringify({storyIds:e,reason:t})}),getAllUsers:e=>apiRequest("/users/admin/all".concat(e?"?".concat(e):"")),suspendUser:(e,t,s)=>apiRequest("/admin/users/".concat(e,"/suspend"),{method:"PATCH",body:JSON.stringify({reason:t,duration:s})}),unsuspendUser:e=>apiRequest("/admin/users/".concat(e,"/unsuspend"),{method:"PATCH"}),deleteUser:e=>apiRequest("/users/".concat(e),{method:"DELETE"}),getAllAdmins:()=>apiRequest("/admin/admins"),getAdminProfile:()=>apiRequest("/admin/profile"),updateAdminProfile:e=>apiRequest("/admin/profile",{method:"PATCH",body:JSON.stringify(e)}),getAdminSettings:()=>apiRequest("/admin/settings"),updateAdminSettings:e=>apiRequest("/admin/settings",{method:"PATCH",body:JSON.stringify(e)}),getAnalytics:()=>apiRequest("/admin/analytics"),getDashboardStats:()=>apiRequest("/admin/dashboard-stats")}},88742:function(e,t,s){"use strict";s.d(t,{Mv:function(){return shareProfile},c0:function(){return showNotification}});let showNotification=e=>{let{type:t,title:s,message:r,duration:a=3e3}=e,n=document.createElement("div");n.className="fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transition-all duration-300 ".concat("success"===t?"bg-green-100 text-green-800 border border-green-200":"error"===t?"bg-red-100 text-red-800 border border-red-200":"warning"===t?"bg-yellow-100 text-yellow-800 border border-yellow-200":"bg-blue-100 text-blue-800 border border-blue-200"),n.innerHTML='\n    <div class="flex items-start">\n      <div class="flex-1">\n        <div class="font-medium">'.concat(s,"</div>\n        ").concat(r?'<div class="text-sm mt-1">'.concat(r,"</div>"):"",'\n      </div>\n      <button class="ml-2 text-gray-400 hover:text-gray-600" onclick="this.parentElement.parentElement.remove()">\n        \xd7\n      </button>\n    </div>\n  '),document.body.appendChild(n),setTimeout(()=>{n.parentElement&&n.remove()},a)},handleAsyncError=function(e){var t,s;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"An unexpected error occurred";console.error("Error:",e);let a=(null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||(null==e?void 0:e.message)||r;showNotification({type:"error",title:"Error",message:a})},showSuccess=(e,t)=>{showNotification({type:"success",title:e,message:t})},shareProfile=async(e,t)=>{let s="".concat(window.location.origin,"/profile/").concat(t.username),r="Check out ".concat(t.name,"'s profile on Dhyey");try{switch(e){case"copy":await navigator.clipboard.writeText(s),showSuccess("Link Copied","Profile link copied to clipboard!");break;case"twitter":window.open("https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(r),"&url=").concat(encodeURIComponent(s)),"_blank");break;case"facebook":window.open("https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(s)),"_blank");break;case"linkedin":window.open("https://www.linkedin.com/sharing/share-offsite/?url=".concat(encodeURIComponent(s)),"_blank");break;default:throw Error("Unsupported platform")}}catch(e){handleAsyncError(e,"Failed to share profile")}}},96871:function(e,t,s){e.exports=s(92054)}},function(e){e.O(0,[2054,6895,7115,2835,1744],function(){return e(e.s=36570)}),_N_E=e.O()}]);