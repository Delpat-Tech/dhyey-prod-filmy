(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4334,2283],{90027:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]])},31621:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},51843:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},52080:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},70423:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},41578:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},57842:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]])},96199:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},63284:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},3910:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},71859:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(57068);let a=(0,r.Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},84334:function(e,t,s){Promise.resolve().then(s.bind(s,11562)),Promise.resolve().then(s.bind(s,16458))},11562:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ProfileHeader}});var r=s(37821),a=s(45039),i=s.n(a),o=s(58078),l=s(96871),n=s.n(l),c=s(63284),d=s(71859),u=s(57068);let h=(0,u.Z)("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);var m=s(96199);function ProfileActions(e){let{isOwnProfile:t,isFollowing:s,onFollow:a,onShare:i,userData:l}=e,[u,x]=(0,o.useState)(!1),[p,f]=(0,o.useState)(!1),g=(0,o.useRef)(null),y=(0,o.useRef)(null);(0,o.useEffect)(()=>{let handleClickOutside=e=>{g.current&&!g.current.contains(e.target)&&x(!1),y.current&&!y.current.contains(e.target)&&f(!1)};return document.addEventListener("mousedown",handleClickOutside),()=>document.removeEventListener("mousedown",handleClickOutside)},[]);let shareProfile=e=>{i(e),x(!1)};return t?(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)(n(),{href:"/profile/edit",className:"flex-1 md:flex-none bg-gray-100 text-gray-900 px-4 py-2 rounded-lg font-medium hover:bg-gray-200 transition-colors inline-flex items-center justify-center",children:[(0,r.jsx)(c.Z,{size:16,className:"inline mr-2"}),"Edit Profile"]}),(0,r.jsx)(n(),{href:"/settings",className:"px-3 py-2 bg-gray-100 text-gray-900 rounded-lg hover:bg-gray-200 transition-colors inline-flex items-center justify-center",children:(0,r.jsx)(d.Z,{size:16})})]}):(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:a,className:"flex-1 md:flex-none px-4 py-2 rounded-lg font-medium transition-colors ".concat(s?"bg-gray-100 text-gray-900 hover:bg-gray-200":"bg-purple-500 text-white hover:bg-purple-600"),children:s?"Following":"Follow"}),(0,r.jsxs)("div",{className:"relative",ref:g,children:[(0,r.jsx)("button",{onClick:()=>{x(!u),f(!1)},className:"px-3 py-2 bg-gray-100 text-gray-900 rounded-lg hover:bg-gray-200 transition-colors",children:(0,r.jsx)(h,{size:16})}),u&&(0,r.jsxs)("div",{className:"absolute right-0 top-full mt-2 bg-white border border-gray-200 rounded-lg shadow-xl py-1 z-50 min-w-[180px]",children:[(0,r.jsx)("button",{onClick:()=>shareProfile("copy"),className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"\uD83D\uDCCB Copy Profile Link"}),(0,r.jsx)("button",{onClick:()=>shareProfile("twitter"),className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"\uD83D\uDC26 Share on Twitter"}),(0,r.jsx)("button",{onClick:()=>shareProfile("facebook"),className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"\uD83D\uDCD8 Share on Facebook"}),(0,r.jsx)("button",{onClick:()=>shareProfile("linkedin"),className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"\uD83D\uDCBC Share on LinkedIn"})]})]}),(0,r.jsxs)("div",{className:"relative",ref:y,children:[(0,r.jsx)("button",{onClick:()=>{f(!p),x(!1)},className:"px-3 py-2 bg-gray-100 text-gray-900 rounded-lg hover:bg-gray-200 transition-colors",children:(0,r.jsx)(m.Z,{size:16})}),p&&(0,r.jsxs)("div",{className:"absolute right-0 top-full mt-2 bg-white border border-gray-200 rounded-lg shadow-xl py-1 z-50 min-w-[160px]",children:[(0,r.jsx)("button",{onClick:()=>{console.log("Send message"),f(!1)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"\uD83D\uDCAC Send Message"}),(0,r.jsx)("button",{onClick:()=>{console.log("Report user"),f(!1)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"\uD83D\uDEA8 Report User"}),(0,r.jsx)("hr",{className:"my-1 border-gray-100"}),(0,r.jsx)("button",{onClick:()=>{console.log("Block user"),f(!1)},className:"w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors font-medium",children:"\uD83D\uDEAB Block User"})]})]})]})}function ProfileStats(e){let{stats:t,isMobile:s=!1}=e,a={stories:(null==t?void 0:t.stories)||0,followers:(null==t?void 0:t.followers)||0,following:(null==t?void 0:t.following)||0,likes:(null==t?void 0:t.likes)||0};return s?(0,r.jsxs)("div",{className:"flex justify-around py-4 border-y border-gray-100 mb-4",children:[(0,r.jsxs)("button",{className:"text-center hover:bg-gray-50 px-2 py-1 rounded transition-colors",children:[(0,r.jsx)("div",{className:"font-bold text-lg text-gray-900",children:a.stories}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Stories"})]}),(0,r.jsxs)(n(),{href:"/profile/followers",className:"text-center hover:bg-gray-50 px-2 py-1 rounded transition-colors",children:[(0,r.jsx)("div",{className:"font-bold text-lg text-gray-900",children:a.followers.toLocaleString()}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Followers"})]}),(0,r.jsxs)(n(),{href:"/profile/following",className:"text-center hover:bg-gray-50 px-2 py-1 rounded transition-colors",children:[(0,r.jsx)("div",{className:"font-bold text-lg text-gray-900",children:a.following}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Following"})]}),(0,r.jsxs)("button",{className:"text-center hover:bg-gray-50 px-2 py-1 rounded transition-colors",children:[(0,r.jsx)("div",{className:"font-bold text-lg text-gray-900",children:a.likes.toLocaleString()}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Likes"})]})]}):(0,r.jsxs)("div",{className:"flex space-x-8 mb-4",children:[(0,r.jsxs)("button",{className:"hover:bg-gray-50 px-2 py-1 rounded transition-colors",children:[(0,r.jsx)("span",{className:"font-bold text-gray-900",children:a.stories}),(0,r.jsx)("span",{className:"text-gray-600 ml-1",children:"stories"})]}),(0,r.jsxs)(n(),{href:"/profile/followers",className:"hover:bg-gray-50 px-2 py-1 rounded transition-colors",children:[(0,r.jsx)("span",{className:"font-bold text-gray-900",children:a.followers.toLocaleString()}),(0,r.jsx)("span",{className:"text-gray-600 ml-1",children:"followers"})]}),(0,r.jsxs)(n(),{href:"/profile/following",className:"hover:bg-gray-50 px-2 py-1 rounded transition-colors",children:[(0,r.jsx)("span",{className:"font-bold text-gray-900",children:a.following}),(0,r.jsx)("span",{className:"text-gray-600 ml-1",children:"following"})]}),(0,r.jsxs)("button",{className:"hover:bg-gray-50 px-2 py-1 rounded transition-colors",children:[(0,r.jsx)("span",{className:"font-bold text-gray-900",children:a.likes.toLocaleString()}),(0,r.jsx)("span",{className:"text-gray-600 ml-1",children:"likes"})]})]})}var x=s(41578),p=s(31621);let f=(0,u.Z)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);function ProfileBio(e){let{bio:t,location:s,joinDate:a,website:i,isMobile:o=!1}=e;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-gray-900 whitespace-pre-line",children:t}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center ".concat(o?"gap-4":"gap-6"," text-sm text-gray-600"),children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(x.Z,{size:14}),(0,r.jsx)("span",{children:s})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(p.Z,{size:14}),(0,r.jsxs)("span",{children:["Joined ",a]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(f,{size:14}),(0,r.jsx)("a",{href:"https://".concat(i),className:"text-purple-600 hover:underline",children:i})]})]})]})}var g=s(88742),y=s(26709),v=s(8494),b=s(86981);function ProfileHeader(e){let{username:t}=e,{user:s,isLoading:a}=(0,y.useAuth)(),[l,n]=(0,o.useState)(!1),[c,d]=(0,o.useState)(null),[u,h]=(0,o.useState)(!0),m=!t||t===(null==s?void 0:s.username);return((0,o.useEffect)(()=>{let fetchProfileData=async()=>{if(m){if(s)try{let e=await v.TV.getMe();d(e.data.user)}catch(e){console.error("Error fetching user data:",e),d(s)}else d(s);h(a)}else if(t){try{let e=await v.TV.getUserProfile(t);d(e.data.user)}catch(e){console.error("Error fetching profile:",e),d(null)}h(!1)}};fetchProfileData()},[s,t,a,m]),u)?(0,r.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,r.jsx)("div",{className:"px-4 py-6",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-start md:space-x-8",children:[(0,r.jsx)("div",{className:"w-20 h-20 md:w-[150px] md:h-[150px] bg-gray-200 rounded-full animate-pulse mb-4 md:mb-0"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded w-48 mb-2 animate-pulse"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-32 mb-4 animate-pulse"}),(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded w-24 animate-pulse"})]})]})})}):c?(0,r.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,r.jsx)("div",{className:"px-4 py-6",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-start md:space-x-8",children:[(0,r.jsx)(i(),{src:(0,b.E$)(c.avatar),alt:c.name||"User",width:80,height:80,className:"rounded-full md:w-[150px] md:h-[150px] mb-4 md:mb-0"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 mb-1",children:c.name||"User"}),(0,r.jsxs)("p",{className:"text-gray-600 mb-3 md:mb-4",children:["@",c.username||"username"]}),(0,r.jsx)(ProfileActions,{isOwnProfile:m,isFollowing:l,onFollow:()=>{n(!l)},onShare:e=>{c&&(0,g.Mv)(e,c)},userData:c})]}),(0,r.jsx)(ProfileStats,{stats:c.stats||{},isMobile:!1}),(0,r.jsx)("div",{className:"md:hidden",children:(0,r.jsx)(ProfileStats,{stats:c.stats||{},isMobile:!0})}),(0,r.jsx)(ProfileBio,{bio:c.bio||"",location:c.location||"",joinDate:c.joinDate||new Date().toISOString(),website:c.website||""})]})]})})}):(0,r.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,r.jsx)("div",{className:"px-4 py-6 text-center",children:(0,r.jsx)("p",{className:"text-gray-600",children:"Please log in to view your profile."})})})}},16458:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ProfileTabs}});var r=s(37821),a=s(58078),i=s(57068);let o=(0,i.Z)("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);var l=s(90027),n=s(70423),c=s(96871),d=s.n(c),u=s(3910),h=s(57842),m=s(52080),x=s(26709),p=s(8494);function StoriesGrid(){let{user:e}=(0,x.useAuth)(),[t,s]=(0,a.useState)([]),[i,l]=(0,a.useState)(!0),[c,f]=(0,a.useState)(null);(0,a.useEffect)(()=>{(null==e?void 0:e.id)&&fetchUserStories()},[null==e?void 0:e.id]);let fetchUserStories=async()=>{try{l(!0);let t=await p.fh.getUserStories(e.id);console.log("Fetched stories:",t.data.stories),s(t.data.stories)}catch(e){console.error("Error fetching stories:",e),f(e.message||"Failed to fetch stories")}finally{l(!1)}};if(i)return(0,r.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})});if(c)return(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("p",{className:"text-red-600 mb-4",children:c}),(0,r.jsx)("button",{onClick:fetchUserStories,className:"text-purple-600 hover:text-purple-700 font-medium",children:"Try Again"})]});let g=t.filter(e=>"approved"===e.status),y=t.filter(e=>"draft"===e.status);return t.filter(e=>"pending"===e.status),(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)(d(),{href:"/create",className:"block w-full p-8 border-2 border-dashed border-gray-300 rounded-xl text-center hover:border-purple-400 hover:bg-purple-50 transition-colors group",children:[(0,r.jsx)(u.Z,{size:32,className:"mx-auto text-gray-400 group-hover:text-purple-500 mb-2"}),(0,r.jsx)("p",{className:"text-gray-600 group-hover:text-purple-600 font-medium",children:"Create New Story"})]}),g.length>0&&(0,r.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 via-white to-indigo-50 border border-purple-100 rounded-2xl p-6 shadow-sm shadow-purple-200/50",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-purple-800",children:"Published Stories"}),(0,r.jsx)("span",{className:"flex-1 h-px bg-gradient-to-r from-purple-200 via-indigo-200 to-transparent"})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(e=>(0,r.jsxs)(d(),{href:"/story/".concat(e._id),className:"group",children:[(0,r.jsxs)("div",{className:"relative aspect-square rounded-2xl overflow-hidden border border-purple-200/70 bg-gradient-to-br from-purple-700 via-indigo-700 to-slate-900 shadow-md shadow-purple-200/40",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-4xl font-semibold text-white/90 tracking-[0.35em]",children:e.title.charAt(0)})}),(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-900/25 via-indigo-900/30 to-slate-900/35 opacity-0 group-hover:opacity-100 transition-all duration-300 backdrop-blur-[2px]"}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-white",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-sm font-medium",children:[(0,r.jsx)(n.Z,{size:16}),(0,r.jsx)("span",{children:e.stats.likes})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-sm font-medium",children:[(0,r.jsx)(h.Z,{size:16}),(0,r.jsx)("span",{children:e.stats.comments})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-sm font-medium",children:[(0,r.jsx)(m.Z,{size:16}),(0,r.jsx)("span",{children:e.stats.views})]})]})}),(0,r.jsx)("div",{className:"absolute top-3 left-3",children:(0,r.jsx)("span",{className:"px-2 py-1 rounded-full border border-white/20 bg-white/10 text-white text-xs font-medium backdrop-blur-sm",children:e.genre})})]}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 group-hover:text-purple-600 transition-colors line-clamp-1",children:e.title}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 mt-1 text-sm text-purple-600/80",children:[(0,r.jsxs)("span",{children:[e.stats.likes," likes"]}),(0,r.jsxs)("span",{children:[e.stats.views," views"]})]})]})]},e._id))})]}),y.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Drafts"}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(e=>(0,r.jsxs)("button",{onClick:()=>alert("Coming Soon!"),className:"group text-left w-full",children:[(0,r.jsxs)("div",{className:"relative aspect-square rounded-xl overflow-hidden bg-gray-100",children:[(0,r.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center opacity-50 group-hover:opacity-75 transition-opacity",children:(0,r.jsx)("span",{className:"text-white text-2xl font-bold",children:e.title.charAt(0)})}),(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 bg-opacity-20 flex items-center justify-center",children:(0,r.jsx)("div",{className:"bg-gray-500 text-white px-3 py-1 rounded-full text-sm font-medium",children:"Draft"})}),(0,r.jsx)("div",{className:"absolute top-2 left-2",children:(0,r.jsx)("span",{className:"px-2 py-1 bg-black bg-opacity-70 text-white text-xs font-medium rounded-full",children:e.genre})})]}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 group-hover:text-purple-600 transition-colors line-clamp-1",children:e.title}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Continue editing"})]})]},e._id))})]}),0===t.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(o,{size:32,className:"text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Stories Yet"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Start sharing your creativity with the world"}),(0,r.jsxs)(d(),{href:"/create",className:"inline-flex items-center space-x-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-full font-medium hover:from-purple-600 hover:to-pink-600 transition-all",children:[(0,r.jsx)(u.Z,{size:16}),(0,r.jsx)("span",{children:"Create Your First Story"})]})]})]})}var f=s(45039),g=s.n(f),y=s(51843),v=s(86981);let b=[{id:7,title:"The Art of Letting Go",author:{name:"Maya Patel",username:"mayapoetry",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=32&h=32&fit=crop&crop=face"},image:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=300&h=300&fit=crop",genre:"Poetry",likes:234,comments:19,savedAt:"2 days ago",excerpt:"Like autumn leaves that dance on wind, our memories float away..."},{id:8,title:"Midnight in Tokyo",author:{name:"Yuki Tanaka",username:"yukistories",avatar:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=32&h=32&fit=crop&crop=face"},image:"https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=300&h=300&fit=crop",genre:"Fiction",likes:567,comments:45,savedAt:"1 week ago",excerpt:"The neon lights reflected off the wet streets as I walked through Shibuya..."},{id:9,title:"The Digital Nomad's Journey",author:{name:"Alex Thompson",username:"alexwrites",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=32&h=32&fit=crop&crop=face"},image:"https://images.unsplash.com/photo-1521737604893-d14cc237f11d?w=300&h=300&fit=crop",genre:"Non-Fiction",likes:342,comments:28,savedAt:"2 weeks ago",excerpt:"Working from coffee shops around the world taught me more than any office..."}];function SavedStories(e){let{activeTab:t}=e,{user:s}=(0,x.useAuth)(),[i,o]=(0,a.useState)([]),[c,u]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(null==s?void 0:s.id)&&fetchSavedStories()},[null==s?void 0:s.id]),(0,a.useEffect)(()=>{"saved"===t&&(null==s?void 0:s.id)&&fetchSavedStories()},[t,null==s?void 0:s.id]),(0,a.useEffect)(()=>{let handleSavedStoriesUpdate=()=>{"saved"===t&&(null==s?void 0:s.id)&&fetchSavedStories()};return window.addEventListener("savedStoriesUpdated",handleSavedStoriesUpdate),()=>window.removeEventListener("savedStoriesUpdated",handleSavedStoriesUpdate)},[t,null==s?void 0:s.id]);let fetchSavedStories=async()=>{try{var e,t;u(!0),console.log("Fetching saved stories for user:",s.id);let r=await p.TV.getUserSavedStories(s.id);console.log("Saved stories response:",r),console.log("Full response data:",r.data);let a=(null===(e=r.data)||void 0===e?void 0:e.stories)||(null===(t=r.data)||void 0===t?void 0:t.savedStories)||r.data||[];console.log("Setting saved stories:",a),o(a)}catch(e){console.error("Error fetching saved stories:",e),o(b)}finally{u(!1)}},handleUnsave=async e=>{try{await p.fh.saveStory(e),o(i.filter(t=>t._id!==e&&t.id!==e))}catch(e){console.error("Error unsaving story:",e)}},handleLike=async e=>{try{await p.fh.likeStory(e),o(i.map(t=>{if(t._id===e||t.id===e){var s;let e=t.likes||(null===(s=t.stats)||void 0===s?void 0:s.likes)||0,r=t.isLiked;return{...t,isLiked:!r,likes:r?e-1:e+1,stats:t.stats?{...t.stats,likes:r?e-1:e+1}:void 0}}return t}))}catch(e){console.error("Error liking story:",e)}};return c?(0,r.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})}):0===i.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(l.Z,{size:32,className:"text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Saved Stories"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Stories you save will appear here"})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Saved Stories"}),(0,r.jsx)("button",{onClick:fetchSavedStories,className:"px-3 py-1 text-sm bg-purple-100 text-purple-700 rounded-full hover:bg-purple-200 transition-colors",children:"Refresh"})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500 mb-2",children:["Found ",i.length," saved stories"]}),i.map(e=>{var t,s,a,i,o,c,u,m,x;let p=e._id||e.id;return(0,r.jsx)("div",{className:"bg-gray-50 rounded-xl border border-gray-100 overflow-hidden hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"md:flex",children:[(0,r.jsx)("div",{className:"md:w-48 h-48 md:h-auto relative flex-shrink-0",children:(0,r.jsx)(d(),{href:"/story/".concat(p),children:(0,r.jsx)(g(),{src:(0,v.Jn)(e.image),alt:e.title,fill:!0,className:"object-cover hover:scale-105 transition-transform duration-300"})})}),(0,r.jsxs)("div",{className:"flex-1 p-4 md:p-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(d(),{href:"/profile/".concat((null===(t=e.author)||void 0===t?void 0:t.username)||"user"),children:(0,r.jsx)(g(),{src:(0,v.E$)(null===(s=e.author)||void 0===s?void 0:s.avatar),alt:(null===(a=e.author)||void 0===a?void 0:a.name)||"User",width:32,height:32,className:"rounded-full"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d(),{href:"/profile/".concat((null===(i=e.author)||void 0===i?void 0:i.username)||"user"),className:"font-medium text-gray-900 hover:text-purple-600",children:(null===(o=e.author)||void 0===o?void 0:o.name)||"User"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,r.jsxs)("span",{children:["@",(null===(c=e.author)||void 0===c?void 0:c.username)||"user"]}),(0,r.jsx)("span",{children:"•"}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(y.Z,{size:12}),(0,r.jsxs)("span",{children:["Saved ",e.savedAt]})]})]})]})]}),(0,r.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-medium",children:e.genre})]}),(0,r.jsxs)(d(),{href:"/story/".concat(p),children:[(0,r.jsx)("h3",{className:"font-bold text-lg text-gray-900 mb-2 hover:text-purple-600 transition-colors",children:e.title}),(0,r.jsx)("p",{className:"text-gray-700 mb-3 line-clamp-2",children:e.excerpt||(null===(u=e.content)||void 0===u?void 0:u.substring(0,150))+"..."})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[(0,r.jsxs)("button",{onClick:()=>handleLike(p),className:"flex items-center space-x-1 hover:text-red-500 transition-colors",children:[(0,r.jsx)(n.Z,{size:16,className:e.isLiked?"fill-red-500 text-red-500":""}),(0,r.jsx)("span",{children:e.likes||(null===(m=e.stats)||void 0===m?void 0:m.likes)||0})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(h.Z,{size:16}),(0,r.jsx)("span",{children:e.comments||(null===(x=e.stats)||void 0===x?void 0:x.comments)||0})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>handleUnsave(p),className:"text-purple-600 hover:text-purple-700 p-1 transition-colors",title:"Remove from saved",children:(0,r.jsx)(l.Z,{size:16,className:"fill-purple-600"})}),(0,r.jsx)(d(),{href:"/story/".concat(p),className:"text-purple-600 hover:text-purple-700 font-medium text-sm",children:"Read"})]})]})]})]})},p)})]})}let j=[{id:10,title:"Code of the Heart",author:{name:"David Kim",username:"davidcodes",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=32&h=32&fit=crop&crop=face"},image:"https://images.unsplash.com/photo-1461749280684-dccba630e2f6?w=300&h=300&fit=crop",genre:"Romance",likes:189,comments:23,likedAt:"3 hours ago",excerpt:"In the world of algorithms and data structures, love was the one equation I couldn't solve..."},{id:11,title:"Whispers of the Forest",author:{name:"Luna Martinez",username:"lunapoetry",avatar:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=32&h=32&fit=crop&crop=face"},image:"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=300&h=300&fit=crop",genre:"Poetry",likes:156,comments:8,likedAt:"1 day ago",excerpt:"Beneath the canopy of ancient oaks, where sunlight dances and shadow cloaks..."},{id:12,title:"The Time Traveler's Dilemma",author:{name:"Marcus Chen",username:"marcusscifi",avatar:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=32&h=32&fit=crop&crop=face"},image:"https://images.unsplash.com/photo-1446776877081-d282a0f896e2?w=300&h=300&fit=crop",genre:"Sci-Fi",likes:423,comments:67,likedAt:"3 days ago",excerpt:"Every choice creates a new timeline, but some choices should never be made..."}];function LikedStories(){let{user:e}=(0,x.useAuth)(),[t,s]=(0,a.useState)([]),[i,o]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let loadLikedStories=async()=>{try{o(!0);let e=await p.TV.getUserLikedStories();s(e.data.stories||[])}catch(e){console.error("Failed to load liked stories:",e),s(j)}finally{o(!1)}};e&&loadLikedStories()},[e]);let handleUnlike=async e=>{try{await p.fh.likeStory(e),s(t.filter(t=>t._id!==e&&t.id!==e))}catch(e){console.error("Error unliking story:",e)}},handleSave=async e=>{try{await p.fh.saveStory(e),s(t.map(t=>t._id===e||t.id===e?{...t,isSaved:!t.isSaved}:t))}catch(e){console.error("Error saving story:",e)}};return i?(0,r.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,r.jsx)("div",{className:"bg-gray-50 rounded-xl border border-gray-100 overflow-hidden animate-pulse",children:(0,r.jsxs)("div",{className:"md:flex",children:[(0,r.jsx)("div",{className:"md:w-48 h-48 md:h-auto bg-gray-200"}),(0,r.jsxs)("div",{className:"flex-1 p-4 md:p-6",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),(0,r.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),(0,r.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})},e))}):0===t.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(n.Z,{size:32,className:"text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Liked Stories"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Stories you like will appear here"})]}):(0,r.jsx)("div",{className:"space-y-4",children:t.map(e=>{var t,s,a,i,o,c,u,m,x;let p=e._id||e.id;return(0,r.jsx)("div",{className:"bg-gray-50 rounded-xl border border-gray-100 overflow-hidden hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"md:flex",children:[(0,r.jsx)("div",{className:"md:w-48 h-48 md:h-auto relative flex-shrink-0",children:(0,r.jsx)(d(),{href:"/story/".concat(p),children:(0,r.jsx)(g(),{src:(0,v.Jn)(e.image),alt:e.title,fill:!0,className:"object-cover hover:scale-105 transition-transform duration-300"})})}),(0,r.jsxs)("div",{className:"flex-1 p-4 md:p-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(d(),{href:"/profile/".concat((null===(t=e.author)||void 0===t?void 0:t.username)||"user"),children:(0,r.jsx)(g(),{src:(0,v.E$)(null===(s=e.author)||void 0===s?void 0:s.avatar),alt:(null===(a=e.author)||void 0===a?void 0:a.name)||"User",width:32,height:32,className:"rounded-full"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d(),{href:"/profile/".concat((null===(i=e.author)||void 0===i?void 0:i.username)||"user"),className:"font-medium text-gray-900 hover:text-purple-600",children:(null===(o=e.author)||void 0===o?void 0:o.name)||"User"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,r.jsxs)("span",{children:["@",(null===(c=e.author)||void 0===c?void 0:c.username)||"user"]}),(0,r.jsx)("span",{children:"•"}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(y.Z,{size:12}),(0,r.jsxs)("span",{children:["Liked ",e.likedAt]})]})]})]})]}),(0,r.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-medium",children:e.genre})]}),(0,r.jsxs)(d(),{href:"/story/".concat(p),children:[(0,r.jsx)("h3",{className:"font-bold text-lg text-gray-900 mb-2 hover:text-purple-600 transition-colors",children:e.title}),(0,r.jsx)("p",{className:"text-gray-700 mb-3 line-clamp-2",children:e.excerpt||(null===(u=e.content)||void 0===u?void 0:u.substring(0,150))+"..."})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[(0,r.jsxs)("button",{onClick:()=>handleUnlike(p),className:"flex items-center space-x-1 hover:text-red-600 transition-colors",title:"Unlike",children:[(0,r.jsx)(n.Z,{size:16,className:"fill-red-500 text-red-500"}),(0,r.jsx)("span",{children:e.likes||(null===(m=e.stats)||void 0===m?void 0:m.likes)||0})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(h.Z,{size:16}),(0,r.jsx)("span",{children:e.comments||(null===(x=e.stats)||void 0===x?void 0:x.comments)||0})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>handleSave(p),className:"text-gray-600 hover:text-purple-600 p-1 transition-colors",title:e.isSaved?"Unsave":"Save",children:(0,r.jsx)(l.Z,{size:16,className:e.isSaved?"fill-purple-600 text-purple-600":""})}),(0,r.jsx)(d(),{href:"/story/".concat(p),className:"text-purple-600 hover:text-purple-700 font-medium text-sm",children:"Read"})]})]})]})]})},p)})})}let w=[{id:"stories",label:"Stories",icon:o},{id:"saved",label:"Saved",icon:l.Z},{id:"liked",label:"Liked",icon:n.Z}];function ProfileTabs(e){let{username:t}=e,[s,i]=(0,a.useState)("stories");return(0,r.jsxs)("div",{className:"bg-white",children:[(0,r.jsx)("div",{className:"border-b border-gray-200",children:(0,r.jsx)("div",{className:"flex justify-center",children:w.map(e=>{let{id:t,label:a,icon:o}=e;return(0,r.jsxs)("button",{onClick:()=>i(t),className:"flex items-center space-x-2 px-6 py-4 text-sm font-medium border-b-2 transition-colors ".concat(s===t?"border-purple-500 text-purple-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"),children:[(0,r.jsx)(o,{size:16}),(0,r.jsx)("span",{className:"hidden sm:inline",children:a})]},t)})})}),(0,r.jsx)("div",{className:"p-4",children:(()=>{switch(s){case"stories":default:return(0,r.jsx)(StoriesGrid,{});case"saved":return(0,r.jsx)(SavedStories,{activeTab:s});case"liked":return(0,r.jsx)(LikedStories,{})}})()})]})}},26709:function(e,t,s){"use strict";s.r(t),s.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth},withAuth:function(){return withAuth}});var r=s(37821),a=s(58078),i=s(8494);let o=(0,a.createContext)(void 0);function AuthProvider(e){let{children:t}=e,[s,l]=(0,a.useState)(null),[n,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{checkAuthStatus()},[]);let checkAuthStatus=async()=>{try{let e=localStorage.getItem("dhyey_user"),t=localStorage.getItem("dhyey_token"),s=localStorage.getItem("dhyey_token_expiry");if(e&&t){if(s&&new Date().getTime()>parseInt(s)){console.log("Token expired, logging out"),logout();return}l(JSON.parse(e)),validateTokenInBackground(t)}}catch(e){console.error("Auth check failed:",e),logout()}finally{c(!1)}},validateTokenInBackground=async e=>{try{let t=await fetch("".concat("https://api.dhyey.delpat.in/api/v1","/users/me"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},credentials:"include"});t.ok||(console.log("Token validation failed, logging out"),logout())}catch(e){console.error("Background token validation failed:",e)}},checkTokenValidity=async()=>{try{let e=localStorage.getItem("dhyey_token");if(!e)return!1;let t=await fetch("".concat("https://api.dhyey.delpat.in/api/v1","/users/me"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},credentials:"include"});return t.ok}catch(e){return console.error("Token validation failed:",e),!1}},login=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];c(!0);try{let r=await i.kv.login(e,t),a={id:r.data.user._id,name:r.data.user.name,username:r.data.user.username,email:r.data.user.email,avatar:r.data.user.avatar,role:r.data.user.role||"user"},o=s?new Date().getTime()+2592e6:new Date().getTime()+864e5;localStorage.setItem("dhyey_user",JSON.stringify(a)),localStorage.setItem("dhyey_token",r.token),localStorage.setItem("dhyey_token_expiry",o.toString()),localStorage.setItem("dhyey_remember_me",s.toString()),l(a)}catch(e){if(e.message&&e.message.includes("suspended"))throw Error("Your account has been suspended. Please contact administration for further details.");throw e}finally{c(!1)}},register=async e=>{c(!0);try{let t=await i.kv.register(e),s={id:t.data.user._id,name:t.data.user.name,username:t.data.user.username,email:t.data.user.email,avatar:t.data.user.avatar,role:t.data.user.role||"user"};localStorage.setItem("dhyey_user",JSON.stringify(s)),localStorage.setItem("dhyey_token",t.token),l(s)}finally{c(!1)}},logout=async()=>{try{await i.kv.logout()}catch(e){console.error("Backend logout failed:",e)}localStorage.removeItem("dhyey_user"),localStorage.removeItem("dhyey_token"),localStorage.removeItem("dhyey_token_expiry"),localStorage.removeItem("dhyey_remember_me"),l(null),window.location.href="/auth/login"};return(0,r.jsx)(o.Provider,{value:{user:s,isLoading:n,isAuthenticated:!!s,login,register,logout,updateUser:e=>{if(s){let t={...s,...e};l(t),localStorage.setItem("dhyey_user",JSON.stringify(t))}},checkTokenValidity},children:t})}function useAuth(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function withAuth(e){return function(t){let{isAuthenticated:s,isLoading:a}=useAuth();return a?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})}):s?(0,r.jsx)(e,{...t}):(window.location.href="/auth/login",null)}}},8494:function(e,t,s){"use strict";s.d(t,{OF:function(){return l},Sb:function(){return n},TV:function(){return i},fh:function(){return o},kv:function(){return a}});let r="https://api.dhyey.delpat.in/api/v1",apiRequest=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=localStorage.getItem("dhyey_token"),a=localStorage.getItem("dhyey_token_expiry");if(s&&a&&new Date().getTime()>parseInt(a))throw console.log("Token expired, clearing session"),localStorage.removeItem("dhyey_user"),localStorage.removeItem("dhyey_token"),localStorage.removeItem("dhyey_token_expiry"),localStorage.removeItem("dhyey_remember_me"),window.location.pathname.includes("/auth/")||(window.location.href="/auth/login"),Error("Session expired. Please log in again.");let i={...t,headers:{"Content-Type":"application/json",...s&&{Authorization:"Bearer ".concat(s)},...t.headers},...s&&{credentials:"include"}},o=await fetch("".concat(r).concat(e),i);if(401===o.status){if(e.includes("/auth/update-password")||e.includes("/auth/change-password")){let e=await o.json().catch(()=>({}));throw Error(e.message||"Current password is incorrect")}throw console.log("Unauthorized request, clearing session"),localStorage.removeItem("dhyey_user"),localStorage.removeItem("dhyey_token"),localStorage.removeItem("dhyey_token_expiry"),localStorage.removeItem("dhyey_remember_me"),window.location.pathname.includes("/auth/")||(window.location.href="/auth/login"),Error("Session expired. Please log in again.")}if(!o.ok){let e=await o.json().catch(()=>({}));throw Error(e.message||"HTTP error! status: ".concat(o.status))}return o.json()},a={login:(e,t)=>fetch("".concat(r,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(async e=>{if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.message||"HTTP error! status: ".concat(e.status))}return e.json()}),register:e=>fetch("".concat(r,"/auth/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(async e=>{let t=await e.json();if(!e.ok)throw Error(t.message||"HTTP error! status: ".concat(e.status));return t}),forgotPassword:e=>apiRequest("/auth/forgot-password",{method:"POST",body:JSON.stringify({email:e})}),resetPassword:(e,t,s)=>apiRequest("/auth/reset-password/".concat(e),{method:"PATCH",body:JSON.stringify({password:t,passwordConfirm:s})}),updatePassword:(e,t,s)=>apiRequest("/auth/update-password",{method:"PATCH",body:JSON.stringify({passwordCurrent:e,password:t,passwordConfirm:s})}),changePassword:(e,t,s)=>apiRequest("/auth/change-password",{method:"PATCH",body:JSON.stringify({passwordCurrent:e,password:t,passwordConfirm:s})}),logout:()=>apiRequest("/auth/logout",{method:"POST"}),refreshToken:()=>apiRequest("/auth/refresh-token",{method:"POST"})},i={getMe:()=>apiRequest("/users/me"),updateMe:e=>apiRequest("/users/me",{method:"PATCH",body:JSON.stringify(e)}),getUserProfile:e=>apiRequest("/users/profile/".concat(e)),followUser:e=>apiRequest("/users/".concat(e,"/follow"),{method:"POST"}),getUserFollowers:e=>apiRequest("/users/".concat(e,"/followers")),getUserFollowing:e=>apiRequest("/users/".concat(e,"/following")),getUserSavedStories:e=>apiRequest("/users/".concat(e,"/saved")),getUserLikedStories:()=>apiRequest("/users/me/liked"),getAllUsers:()=>apiRequest("/users/admin/all")},o={getPublicStories:e=>apiRequest("/stories".concat(e?"?".concat(e):"")),getStoryById:e=>apiRequest("/stories/".concat(e)),createStory:e=>apiRequest("/stories",{method:"POST",body:JSON.stringify(e)}),updateStory:(e,t)=>apiRequest("/stories/".concat(e),{method:"PATCH",body:JSON.stringify(t)}),deleteStory:e=>apiRequest("/stories/".concat(e),{method:"DELETE"}),likeStory:e=>apiRequest("/stories/".concat(e,"/like"),{method:"POST"}),saveStory:e=>apiRequest("/stories/".concat(e,"/save"),{method:"POST"}),shareStory:(e,t)=>apiRequest("/stories/".concat(e,"/share"),{method:"POST",body:JSON.stringify(t||{})}),getUserStories:e=>apiRequest("/stories/user/".concat(e)),searchStories:(e,t)=>{let s=new URLSearchParams({q:e,...t});return apiRequest("/stories/search?".concat(s))},getStoryComments:e=>apiRequest("/stories/".concat(e,"/comments")),addComment:(e,t,s)=>apiRequest("/stories/".concat(e,"/comments"),{method:"POST",body:JSON.stringify({content:t,parentComment:s})}),likeComment:(e,t)=>apiRequest("/stories/".concat(e,"/comments/").concat(t,"/like"),{method:"POST"})},l={searchStories:(e,t)=>{let s=t?Object.fromEntries(Object.entries(t).filter(e=>{let[t,s]=e;return null!=s&&""!==s})):{},r=new URLSearchParams({q:e,...s});return console.log("API call URL:","/search/stories?".concat(r)),apiRequest("/search/stories?".concat(r))},searchUsers:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/users?".concat(t))},getSearchSuggestions:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/suggestions?".concat(t))},getSearchFilters:()=>apiRequest("/search/filters"),globalSearch:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/global?".concat(t))}},n={getAllStories:e=>apiRequest("/admin/stories".concat(e?"?".concat(e):"")),getStoryForReview:e=>apiRequest("/admin/stories/".concat(e)),approveStory:e=>apiRequest("/admin/stories/".concat(e,"/approve"),{method:"PATCH"}),rejectStory:(e,t)=>apiRequest("/admin/stories/".concat(e,"/reject"),{method:"PATCH",body:JSON.stringify({reason:t})}),bulkApproveStories:e=>apiRequest("/admin/stories/bulk-approve",{method:"PATCH",body:JSON.stringify({storyIds:e})}),bulkRejectStories:(e,t)=>apiRequest("/admin/stories/bulk-reject",{method:"PATCH",body:JSON.stringify({storyIds:e,reason:t})}),getAllUsers:e=>apiRequest("/users/admin/all".concat(e?"?".concat(e):"")),suspendUser:(e,t,s)=>apiRequest("/admin/users/".concat(e,"/suspend"),{method:"PATCH",body:JSON.stringify({reason:t,duration:s})}),unsuspendUser:e=>apiRequest("/admin/users/".concat(e,"/unsuspend"),{method:"PATCH"}),deleteUser:e=>apiRequest("/users/".concat(e),{method:"DELETE"}),getAllAdmins:()=>apiRequest("/admin/admins"),getAdminProfile:()=>apiRequest("/admin/profile"),updateAdminProfile:e=>apiRequest("/admin/profile",{method:"PATCH",body:JSON.stringify(e)}),getAdminSettings:()=>apiRequest("/admin/settings"),updateAdminSettings:e=>apiRequest("/admin/settings",{method:"PATCH",body:JSON.stringify(e)}),getAnalytics:()=>apiRequest("/admin/analytics"),getDashboardStats:()=>apiRequest("/admin/dashboard-stats")}},88742:function(e,t,s){"use strict";s.d(t,{Mv:function(){return shareProfile},c0:function(){return showNotification}});let showNotification=e=>{let{type:t,title:s,message:r,duration:a=3e3}=e,i=document.createElement("div");i.className="fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transition-all duration-300 ".concat("success"===t?"bg-green-100 text-green-800 border border-green-200":"error"===t?"bg-red-100 text-red-800 border border-red-200":"warning"===t?"bg-yellow-100 text-yellow-800 border border-yellow-200":"bg-blue-100 text-blue-800 border border-blue-200"),i.innerHTML='\n    <div class="flex items-start">\n      <div class="flex-1">\n        <div class="font-medium">'.concat(s,"</div>\n        ").concat(r?'<div class="text-sm mt-1">'.concat(r,"</div>"):"",'\n      </div>\n      <button class="ml-2 text-gray-400 hover:text-gray-600" onclick="this.parentElement.parentElement.remove()">\n        \xd7\n      </button>\n    </div>\n  '),document.body.appendChild(i),setTimeout(()=>{i.parentElement&&i.remove()},a)},handleAsyncError=function(e){var t,s;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"An unexpected error occurred";console.error("Error:",e);let a=(null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||(null==e?void 0:e.message)||r;showNotification({type:"error",title:"Error",message:a})},showSuccess=(e,t)=>{showNotification({type:"success",title:e,message:t})},shareProfile=async(e,t)=>{let s="".concat(window.location.origin,"/profile/").concat(t.username),r="Check out ".concat(t.name,"'s profile on Dhyey");try{switch(e){case"copy":await navigator.clipboard.writeText(s),showSuccess("Link Copied","Profile link copied to clipboard!");break;case"twitter":window.open("https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(r),"&url=").concat(encodeURIComponent(s)),"_blank");break;case"facebook":window.open("https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(s)),"_blank");break;case"linkedin":window.open("https://www.linkedin.com/sharing/share-offsite/?url=".concat(encodeURIComponent(s)),"_blank");break;default:throw Error("Unsupported platform")}}catch(e){handleAsyncError(e,"Failed to share profile")}}},86981:function(e,t,s){"use strict";s.d(t,{E$:function(){return getAvatarUrl},Jn:function(){return getImageUrl}});let getImageUrl=(e,t)=>{if(!e)return t||"https://ui-avatars.com/api/?name=User&background=6366f1&color=fff&size=150";if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("blob:"))return e;let s=e.startsWith("/")?e:"/".concat(e);return"".concat("https://api.dhyey.delpat.in/api/v1").concat(s)},getAvatarUrl=e=>getImageUrl(e,"https://ui-avatars.com/api/?name=User&background=6366f1&color=fff&size=150")},96871:function(e,t,s){e.exports=s(92054)}}]);