(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5415],{25498:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},90027:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]])},31621:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},51843:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},70423:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},57842:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]])},3910:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},81917:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57068);let r=(0,a.Z)("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]])},41486:function(e,t,s){Promise.resolve().then(s.bind(s,38340))},38340:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return StoryPage}});var a=s(37821),r=s(58078),i=s(45039),n=s.n(i),o=s(96871),l=s.n(o),c=s(25498),d=s(31621),h=s(86981),m=s(86965);function StoryHeader(e){let{story:t}=e,[s,i]=(0,r.useState)(t.author.isFollowing),[o,m]=(0,r.useState)(!1),[u,p]=(0,r.useState)(!1),x=(0,r.useRef)(null),g=(0,r.useRef)(null),f=t.status&&!["approved"].includes(t.status);return(0,r.useEffect)(()=>{let handleClickOutside=e=>{x.current&&!x.current.contains(e.target)&&m(!1),g.current&&!g.current.contains(e.target)&&p(!1)};return document.addEventListener("mousedown",handleClickOutside),()=>{document.removeEventListener("mousedown",handleClickOutside)}},[]),(0,a.jsxs)("div",{className:"bg-white border-b border-gray-200",children:[(0,a.jsx)("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:(0,a.jsxs)(l(),{href:"/",className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors",children:[(0,a.jsx)(c.Z,{size:20}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Back to Feed"})]})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("span",{className:"inline-block px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm font-medium",children:t.genre})}),(0,a.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4 leading-tight",children:t.title}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mb-6",children:t.hashtags.map((e,t)=>(0,a.jsx)(l(),{href:"/search?q=".concat(encodeURIComponent(e)),className:"text-purple-600 hover:text-purple-700 hover:underline text-sm",children:e},t))}),!f&&(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)(l(),{href:"/profile/".concat(t.author.username),className:"flex items-center space-x-4 hover:opacity-80 transition-opacity",children:[t.author.avatar?(0,a.jsx)(n(),{src:(0,h.E$)(t.author.avatar),alt:t.author.name,width:50,height:50,className:"rounded-full object-cover border-2 border-transparent hover:border-purple-200 transition-colors"}):(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full flex items-center justify-center border-2 border-transparent hover:border-purple-200 transition-colors",children:(0,a.jsx)("span",{className:"text-white font-bold text-lg",children:t.author.name.charAt(0)})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 hover:text-purple-600 transition-colors",children:t.author.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["@",t.author.username," • ",(t.author.followers||0).toLocaleString()," followers"]})]})]}),(0,a.jsx)("button",{onClick:()=>{i(!s)},className:"px-6 py-2 rounded-full font-medium transition-colors ".concat(s?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-purple-500 text-white hover:bg-purple-600"),children:s?"Following":"Follow"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-6 text-sm text-gray-600 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(d.Z,{size:16}),(0,a.jsx)("span",{children:new Date(t.publishedAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),(0,a.jsx)("div",{className:"flex items-center space-x-1",children:(0,a.jsx)("span",{children:t.readTime})})]}),t.image&&(0,a.jsx)("div",{className:"relative aspect-video rounded-xl overflow-hidden",children:(0,a.jsx)(n(),{src:(0,h.Jn)(t.image),alt:t.title,fill:!0,className:"object-cover",priority:!0})})]})]})}var u=s(57068);let p=(0,u.Z)("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),x=(0,u.Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var g=s(3910);function StoryContent(e){let{story:t}=e,[s,i]=(0,r.useState)(16),[n,o]=(0,r.useState)(!1),l=t.content.split("\n\n").filter(e=>e.trim());return(0,a.jsxs)("div",{className:"px-6 py-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8 pb-4 border-b border-gray-100",children:[(0,a.jsx)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:(0,a.jsxs)("span",{children:["Reading time: ",t.readTime]})}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)("button",{onClick:()=>o(!n),className:"flex items-center space-x-1 px-3 py-1 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-full transition-colors",children:[(0,a.jsx)(p,{size:16}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Reading Options"})]})})]}),n&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Font Size"}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("button",{onClick:()=>{s>12&&i(s-2)},disabled:s<=12,className:"p-1 text-gray-600 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,a.jsx)(x,{size:16})}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 min-w-[3rem] text-center",children:[s,"px"]}),(0,a.jsx)("button",{onClick:()=>{s<24&&i(s+2)},disabled:s>=24,className:"p-1 text-gray-600 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,a.jsx)(g.Z,{size:16})})]})]})}),(0,a.jsx)("article",{className:"prose prose-lg max-w-none",children:(0,a.jsx)("div",{className:"text-gray-800 leading-relaxed break-words overflow-wrap-anywhere",style:{fontSize:"".concat(s,"px"),lineHeight:"1.7"},children:l.map((e,t)=>(0,a.jsx)("p",{className:"mb-6 break-words",children:e},t))})}),(0,a.jsx)("div",{className:"mt-12 pt-8 border-t border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-500",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),(0,a.jsx)("span",{children:"End of Story"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-purple-500 rounded-full"})]})})]})}var f=s(70423),y=s(57842),v=s(90027),b=s(81917),w=s(8494);function StoryActions(e){let{story:t}=e,[s,i]=(0,r.useState)(t.isLiked),[n,o]=(0,r.useState)(t.isSaved),[l,c]=(0,r.useState)(!1),d=t.status&&!["approved"].includes(t.status),handleLike=async()=>{try{let e=await w.fh.likeStory(t.id.toString());i(e.data.isLiked),t.stats&&(t.stats.likes=e.data.likesCount)}catch(e){console.error("Failed to like story:",e),m.Am.error("Failed to like story. Please try again.")}},handleSave=async()=>{if(!l)try{c(!0);let e=await w.fh.saveStory(t.id.toString()),s=e.data.isSaved;o(s),t.stats&&(t.stats.saves=e.data.savesCount||(s?t.stats.saves+1:t.stats.saves-1)),m.Am.success(s?"Story saved!":"Story removed from saved"),window.dispatchEvent(new CustomEvent("savedStoriesUpdated"))}catch(e){console.error("Failed to save story:",e),m.Am.error("Failed to save story. Please try again.")}finally{c(!1)}};return(0,a.jsx)("div",{className:"px-6 py-6 border-t border-gray-100",children:d?(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center mb-3",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-yellow-400 rounded-full animate-pulse mr-2"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-yellow-800",children:"Story Under Review"})]}),(0,a.jsx)("p",{className:"text-yellow-700 mb-4",children:"This story is currently being reviewed by our moderation team. Interactions will be available once the story is approved and published."}),(0,a.jsxs)("div",{className:"text-sm text-yellow-600",children:[(0,a.jsx)("p",{children:"• Likes, comments, and sharing are temporarily disabled"}),(0,a.jsx)("p",{children:"• You can still read and save the story"})]})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsxs)("button",{onClick:handleLike,className:"flex items-center space-x-2 px-4 py-2 rounded-full transition-all ".concat(s?"bg-red-50 text-red-600 hover:bg-red-100":"text-gray-600 hover:text-red-600 hover:bg-red-50"),children:[(0,a.jsx)(f.Z,{size:20,className:s?"fill-red-600":""}),(0,a.jsx)("span",{className:"font-medium",children:t.stats.likes})]}),(0,a.jsxs)("button",{onClick:()=>{let e=document.getElementById("comments-section");null==e||e.scrollIntoView({behavior:"smooth"})},className:"flex items-center space-x-2 px-4 py-2 rounded-full text-gray-600 hover:text-blue-600 hover:bg-blue-50 transition-all",children:[(0,a.jsx)(y.Z,{size:20}),(0,a.jsx)("span",{className:"font-medium",children:t.stats.comments})]})]}),(0,a.jsxs)("button",{onClick:handleSave,className:"flex items-center space-x-2 px-4 py-2 rounded-full transition-all ".concat(n?"bg-purple-50 text-purple-600 hover:bg-purple-100":"text-gray-600 hover:text-purple-600 hover:bg-purple-50"),children:[(0,a.jsx)(v.Z,{size:20,className:n?"fill-purple-600":""}),(0,a.jsx)("span",{className:"font-medium",children:n?"Saved":"Save"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600 pt-4 border-t border-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{children:[t.stats.likes," likes"]}),(0,a.jsxs)("span",{children:[t.stats.comments," comments"]}),(0,a.jsxs)("span",{children:[t.stats.saves," saves"]})]}),(0,a.jsxs)("button",{className:"flex items-center space-x-1 text-gray-600 hover:text-purple-600 transition-colors",children:[(0,a.jsx)(b.Z,{size:16}),(0,a.jsx)("span",{children:"Show appreciation"})]})]}),(0,a.jsx)("div",{className:"mt-6 p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-100",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-700 mb-3",children:"Enjoyed this story? Support the author and discover more amazing content."}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[(0,a.jsx)("button",{className:"bg-purple-500 text-white px-4 py-2 rounded-full text-sm font-medium hover:bg-purple-600 transition-colors",children:"Follow Author"}),(0,a.jsx)("button",{className:"border border-purple-500 text-purple-600 px-4 py-2 rounded-full text-sm font-medium hover:bg-purple-500 hover:text-white transition-colors",children:"Read More Stories"})]})]})})]})})}var j=s(51843);let N=[{id:2,title:"Digital Dreams",author:{name:"Alex Chen",username:"alexwrites",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face"},excerpt:"In the world of algorithms and data structures, love was the one equation I couldn't solve...",image:"https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=300&h=200&fit=crop",genre:"Fiction",likes:189,comments:23,readTime:"6 min read",timeAgo:"4h"},{id:3,title:"Ocean's Whisper",author:{name:"Luna Martinez",username:"lunapoetry",avatar:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face"},excerpt:"Beneath the canopy of ancient oaks, where sunlight dances and shadow cloaks...",image:"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=300&h=200&fit=crop",genre:"Fiction",likes:156,comments:8,readTime:"4 min read",timeAgo:"6h"},{id:4,title:"City Lights",author:{name:"Marcus Chen",username:"marcuswrites",avatar:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=40&h=40&fit=crop&crop=face"},excerpt:"The neon signs reflected in the rain-soaked streets, each light telling a different story...",image:"https://images.unsplash.com/photo-1519501025264-65ba15a82390?w=300&h=200&fit=crop",genre:"Fiction",likes:298,comments:15,readTime:"7 min read",timeAgo:"1d"}];function RelatedStories(e){let{currentStoryId:t,genre:s}=e,r=N.filter(e=>e.id!==t);return(0,a.jsx)("div",{className:"bg-gray-50 py-12",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"More Stories You Might Like"}),(0,a.jsxs)(l(),{href:"/search?genre=".concat(s),className:"text-purple-600 hover:text-purple-700 font-medium",children:["View All ",s]})]}),(0,a.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(e=>(0,a.jsx)(l(),{href:"/story/".concat(e.id),className:"group",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"relative aspect-video overflow-hidden",children:[(0,a.jsx)(n(),{src:e.image,alt:e.title,fill:!0,className:"object-cover group-hover:scale-105 transition-transform duration-300"}),(0,a.jsx)("div",{className:"absolute top-3 left-3",children:(0,a.jsx)("span",{className:"px-2 py-1 bg-black bg-opacity-70 text-white text-xs font-medium rounded-full",children:e.genre})})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,a.jsx)(n(),{src:e.author.avatar,alt:e.author.name,width:24,height:24,className:"rounded-full"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.author.name}),(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"•"}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:e.timeAgo})]}),(0,a.jsx)("h3",{className:"font-bold text-lg text-gray-900 mb-2 group-hover:text-purple-600 transition-colors line-clamp-2",children:e.title}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:e.excerpt}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(f.Z,{size:14}),(0,a.jsx)("span",{children:e.likes})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(y.Z,{size:14}),(0,a.jsx)("span",{children:e.comments})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(j.Z,{size:14}),(0,a.jsx)("span",{children:e.readTime})]})]})]})]})},e.id))}),(0,a.jsx)("div",{className:"text-center mt-12",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl p-8 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Discover More Amazing Stories"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Explore thousands of stories from talented writers around the world"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[(0,a.jsx)(l(),{href:"/",className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-full font-medium hover:from-purple-600 hover:to-pink-600 transition-all",children:"Browse All Stories"}),(0,a.jsx)(l(),{href:"/search",className:"border border-purple-500 text-purple-600 px-6 py-3 rounded-full font-medium hover:bg-purple-500 hover:text-white transition-all",children:"Search Stories"})]})]})})]})})}let S=[{id:1,author:{name:"Alex Chen",username:"alexreads",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face"},content:"This story gave me chills! The way you described the train station brought back so many memories of my own travels. Beautiful writing! ✨",likes:12,timeAgo:"2h",isLiked:!1,replies:[{id:11,author:{name:"Emma Wilson",username:"emmawrites",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=32&h=32&fit=crop&crop=face"},content:"Thank you so much! That means the world to me. I'm glad it resonated with you! \uD83D\uDC9C",likes:3,timeAgo:"1h",isLiked:!1}]},{id:2,author:{name:"Maya Patel",username:"mayareads",avatar:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face"},content:"The imagery in this piece is absolutely stunning. I could visualize every scene perfectly. Can't wait to read more of your work!",likes:8,timeAgo:"4h",isLiked:!0,replies:[]},{id:3,author:{name:"David Kim",username:"davidwrites",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face"},content:"This reminds me of my own journey to the city years ago. The emotions you captured are so real and relatable. Excellent storytelling!",likes:15,timeAgo:"6h",isLiked:!1,replies:[]}];function CommentsSection(e){let{storyId:t,storyStatus:s}=e,[i,o]=(0,r.useState)(S),[l,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(""),[u,p]=(0,r.useState)(null),[x,g]=(0,r.useState)(""),[f,y]=(0,r.useState)(!1),v=s&&!["approved"].includes(s);if((0,r.useEffect)(()=>{let loadComments=async()=>{try{c(!0);let e=await w.fh.getStoryComments(t.toString());o(e.data.comments||[])}catch(e){console.error("Failed to load comments:",e)}finally{c(!1)}};loadComments()},[t]),v)return null;let handleSubmitComment=async e=>{if(e.preventDefault(),d.trim())try{let e=await w.fh.addComment(t.toString(),d),s={id:e.data.comment._id,author:e.data.comment.author,content:e.data.comment.content,likes:0,timeAgo:"now",isLiked:!1,replies:[]};o(e=>[s,...e]),m(""),window.dispatchEvent(new CustomEvent("storyUpdated",{detail:{storyId:t}}))}catch(e){console.error("Failed to add comment:",e)}},handleSubmitReply=async(e,s)=>{if(e.preventDefault(),x.trim())try{let e=await w.fh.addComment(t.toString(),x,s.toString()),a={id:e.data.comment._id,author:e.data.comment.author,content:e.data.comment.content,likes:0,timeAgo:"now",isLiked:!1};o(e=>e.map(e=>e.id===s?{...e,replies:[...e.replies,a]}:e)),g(""),p(null),window.dispatchEvent(new CustomEvent("storyUpdated",{detail:{storyId:t}}))}catch(e){console.error("Failed to add reply:",e)}},b=f?i:i.slice(0,3);return l?(0,a.jsx)("div",{className:"bg-white px-4 py-6",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-full"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/4"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]})})]})}):(0,a.jsxs)("div",{id:"comments-section",className:"bg-white",children:[(0,a.jsx)("div",{className:"px-4 py-3",children:b.map(e=>(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(n(),{src:(0,h.E$)(e.author.avatar),alt:e.author.name,width:32,height:32,className:"rounded-full flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-baseline flex-wrap",children:[(0,a.jsx)("span",{className:"font-semibold text-black text-sm mr-2",children:e.author.username}),(0,a.jsx)("span",{className:"text-black text-sm break-words",children:e.content})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:e.timeAgo}),(0,a.jsx)("button",{onClick:()=>p(u===e.id?null:e.id),className:"text-xs text-gray-500 font-medium hover:text-gray-700",children:"Reply"})]}),e.replies.length>0&&(0,a.jsx)("div",{className:"mt-3 space-y-3",children:e.replies.map(t=>(0,a.jsxs)("div",{className:"flex items-start space-x-3 ml-6",children:[(0,a.jsx)(n(),{src:(0,h.E$)(t.author.avatar),alt:t.author.name,width:24,height:24,className:"rounded-full flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-baseline flex-wrap",children:[(0,a.jsx)("span",{className:"font-semibold text-black text-sm mr-2",children:t.author.username}),(0,a.jsx)("span",{className:"text-black text-sm break-words",children:t.content})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-1",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:t.timeAgo}),(0,a.jsx)("button",{onClick:()=>p(u===e.id?null:e.id),className:"text-xs text-gray-500 font-medium hover:text-gray-700",children:"Reply"})]})]})]},t.id))}),u===e.id&&(0,a.jsx)("div",{className:"mt-3 ml-6",children:(0,a.jsxs)("form",{onSubmit:t=>handleSubmitReply(t,e.id),className:"flex items-center space-x-3",children:[(0,a.jsx)(n(),{src:"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=24&h=24&fit=crop&crop=face",alt:"Your avatar",width:24,height:24,className:"rounded-full flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 flex items-center",children:[(0,a.jsx)("input",{type:"text",value:x,onChange:e=>g(e.target.value),placeholder:"Reply to ".concat(e.author.username,"..."),className:"flex-1 text-sm border-none outline-none bg-transparent placeholder-gray-500",autoFocus:!0}),x.trim()&&(0,a.jsx)("button",{type:"submit",className:"text-blue-500 hover:text-blue-600 font-semibold text-sm ml-2",children:"Post"})]})]})})]})]})},e.id))}),!f&&i.length>3&&(0,a.jsx)("div",{className:"px-4 pb-3",children:(0,a.jsxs)("button",{onClick:()=>y(!0),className:"text-gray-500 text-sm hover:text-gray-700",children:["View all ",i.length," comments"]})}),(0,a.jsx)("div",{className:"border-t border-gray-200 px-4 py-3",children:(0,a.jsxs)("form",{onSubmit:handleSubmitComment,className:"flex items-center space-x-3",children:[(0,a.jsx)(n(),{src:"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=32&h=32&fit=crop&crop=face",alt:"Your avatar",width:32,height:32,className:"rounded-full flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 flex items-center",children:[(0,a.jsx)("input",{type:"text",value:d,onChange:e=>{let t=e.target.value;m(t)},placeholder:"Add a comment...",className:"flex-1 text-sm py-2 px-0 border-none outline-none bg-transparent text-black placeholder-gray-400",autoComplete:"off"}),d.trim().length>0&&(0,a.jsx)("button",{type:"submit",className:"text-blue-500 hover:text-blue-600 font-semibold text-sm ml-2",onClick:e=>{handleSubmitComment(e)},children:"Post"})]})]})})]})}let getMockStoryData=e=>({id:parseInt(e),title:"The Midnight Train",author:{name:"Emma Wilson",username:"emmawrites",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=50&h=50&fit=crop&crop=face",bio:"Fiction writer and coffee enthusiast",followers:1247,isFollowing:!1},content:'The old train station stood empty, its platforms echoing with memories of countless journeys. Sarah clutched her suitcase tighter as the midnight train approached, its headlight cutting through the darkness like a beacon of hope.\n\nShe had been waiting for this moment for months, ever since she received the letter that changed everything. The job offer in the city was more than just an opportunity—it was her chance to escape the small town that had held her back for so long.\n\nAs the train pulled into the station with a thunderous roar, Sarah felt a mixture of excitement and fear coursing through her veins. The conductor stepped down, his weathered face illuminated by the station\'s dim lights.\n\n"All aboard!" he called out, his voice carrying across the empty platform.\n\nSarah took a deep breath and stepped forward. This was it—the beginning of her new life. As she climbed aboard the train, she couldn\'t help but look back one last time at the town she was leaving behind.\n\nThe train began to move, slowly at first, then picking up speed. Through the window, Sarah watched as the familiar landmarks of her childhood disappeared into the darkness. The old oak tree where she used to read, the corner store where she bought her first notebook, the school where she discovered her love for writing—all of it fading away like a distant memory.\n\nBut as the train carried her toward her future, Sarah felt something she hadn\'t experienced in years: hope. The city awaited, full of possibilities and new adventures. She opened her notebook and began to write, the rhythmic sound of the train on the tracks providing the perfect soundtrack for her thoughts.\n\n"Chapter One," she wrote, "The Journey Begins."\n\nHours passed as the train cut through the night, carrying its passengers toward their destinations. Sarah dozed fitfully, her dreams filled with images of towering skyscrapers and bustling streets. When she woke, the first light of dawn was creeping across the horizon.\n\nThe conductor\'s voice crackled over the intercom: "Next stop, Central Station. All passengers for the city, please prepare to disembark."\n\nSarah gathered her belongings, her heart racing with anticipation. As the train pulled into the massive station, she marveled at the sight before her. Hundreds of people moved through the terminal like a choreographed dance, each with their own story, their own destination.\n\nShe stepped off the train and into her new life, ready to write the next chapter of her story.',image:"https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?w=800&h=400&fit=crop",genre:"Fiction",hashtags:["#fiction","#mystery","#train","#newbeginnings"],publishedAt:"2024-01-15T10:30:00Z",readTime:"8 min read",stats:{likes:234,saves:45,comments:12,views:1520},isLiked:!1,isSaved:!1});function StoryPage(e){let{params:t}=e,[s,i]=(0,r.useState)(null),[n,o]=(0,r.useState)(!0),loadStory=async()=>{try{let e=await w.fh.getStoryById(t.id),s=e.data.story;console.log("Loaded story bookmark state:",s.isSaved),i(s)}catch(s){var e;console.error("Failed to load story:",s),(null===(e=s.message)||void 0===e?void 0:e.includes("Story not available"))?i(null):i(getMockStoryData(t.id))}finally{o(!1)}};return((0,r.useEffect)(()=>{loadStory();let handleStoryUpdate=e=>{e.detail.storyId===parseInt(t.id)&&loadStory()};return window.addEventListener("storyUpdated",handleStoryUpdate),()=>{window.removeEventListener("storyUpdated",handleStoryUpdate)}},[t.id]),n)?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 animate-pulse",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-3/4 mb-4"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-6"}),(0,a.jsx)("div",{className:"h-64 bg-gray-200 rounded mb-6"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]})]})})}):s?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsx)(StoryHeader,{story:s}),(0,a.jsxs)("div",{className:"bg-white",children:[(0,a.jsx)(StoryContent,{story:s}),(0,a.jsx)(StoryActions,{story:s}),(0,a.jsx)(CommentsSection,{storyId:s.id,storyStatus:s.status})]}),(0,a.jsx)(RelatedStories,{currentStoryId:s.id,genre:s.genre})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Story Not Available"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"This story is currently under review or not accessible."}),(0,a.jsx)("button",{onClick:()=>window.history.back(),className:"text-purple-600 hover:text-purple-700 font-medium",children:"Go Back"})]})})}},8494:function(e,t,s){"use strict";s.d(t,{OF:function(){return o},Sb:function(){return l},TV:function(){return i},fh:function(){return n},kv:function(){return r}});let a="https://api.dhyey.delpat.in/api/v1",apiRequest=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=localStorage.getItem("dhyey_token"),r=localStorage.getItem("dhyey_token_expiry");if(s&&r&&new Date().getTime()>parseInt(r))throw console.log("Token expired, clearing session"),localStorage.removeItem("dhyey_user"),localStorage.removeItem("dhyey_token"),localStorage.removeItem("dhyey_token_expiry"),localStorage.removeItem("dhyey_remember_me"),window.location.pathname.includes("/auth/")||(window.location.href="/auth/login"),Error("Session expired. Please log in again.");let i={...t,headers:{"Content-Type":"application/json",...s&&{Authorization:"Bearer ".concat(s)},...t.headers},...s&&{credentials:"include"}},n=await fetch("".concat(a).concat(e),i);if(401===n.status){if(e.includes("/auth/update-password")||e.includes("/auth/change-password")){let e=await n.json().catch(()=>({}));throw Error(e.message||"Current password is incorrect")}throw console.log("Unauthorized request, clearing session"),localStorage.removeItem("dhyey_user"),localStorage.removeItem("dhyey_token"),localStorage.removeItem("dhyey_token_expiry"),localStorage.removeItem("dhyey_remember_me"),window.location.pathname.includes("/auth/")||(window.location.href="/auth/login"),Error("Session expired. Please log in again.")}if(!n.ok){let e=await n.json().catch(()=>({}));throw Error(e.message||"HTTP error! status: ".concat(n.status))}return n.json()},r={login:(e,t)=>fetch("".concat(a,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(async e=>{if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.message||"HTTP error! status: ".concat(e.status))}return e.json()}),register:e=>fetch("".concat(a,"/auth/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(async e=>{let t=await e.json();if(!e.ok)throw Error(t.message||"HTTP error! status: ".concat(e.status));return t}),forgotPassword:e=>apiRequest("/auth/forgot-password",{method:"POST",body:JSON.stringify({email:e})}),resetPassword:(e,t,s)=>apiRequest("/auth/reset-password/".concat(e),{method:"PATCH",body:JSON.stringify({password:t,passwordConfirm:s})}),updatePassword:(e,t,s)=>apiRequest("/auth/update-password",{method:"PATCH",body:JSON.stringify({passwordCurrent:e,password:t,passwordConfirm:s})}),changePassword:(e,t,s)=>apiRequest("/auth/change-password",{method:"PATCH",body:JSON.stringify({passwordCurrent:e,password:t,passwordConfirm:s})}),logout:()=>apiRequest("/auth/logout",{method:"POST"}),refreshToken:()=>apiRequest("/auth/refresh-token",{method:"POST"})},i={getMe:()=>apiRequest("/users/me"),updateMe:e=>apiRequest("/users/me",{method:"PATCH",body:JSON.stringify(e)}),getUserProfile:e=>apiRequest("/users/profile/".concat(e)),followUser:e=>apiRequest("/users/".concat(e,"/follow"),{method:"POST"}),getUserFollowers:e=>apiRequest("/users/".concat(e,"/followers")),getUserFollowing:e=>apiRequest("/users/".concat(e,"/following")),getUserSavedStories:e=>apiRequest("/users/".concat(e,"/saved")),getUserLikedStories:()=>apiRequest("/users/me/liked"),getAllUsers:()=>apiRequest("/users/admin/all")},n={getPublicStories:e=>apiRequest("/stories".concat(e?"?".concat(e):"")),getStoryById:e=>apiRequest("/stories/".concat(e)),createStory:e=>apiRequest("/stories",{method:"POST",body:JSON.stringify(e)}),updateStory:(e,t)=>apiRequest("/stories/".concat(e),{method:"PATCH",body:JSON.stringify(t)}),deleteStory:e=>apiRequest("/stories/".concat(e),{method:"DELETE"}),likeStory:e=>apiRequest("/stories/".concat(e,"/like"),{method:"POST"}),saveStory:e=>apiRequest("/stories/".concat(e,"/save"),{method:"POST"}),shareStory:(e,t)=>apiRequest("/stories/".concat(e,"/share"),{method:"POST",body:JSON.stringify(t||{})}),getUserStories:e=>apiRequest("/stories/user/".concat(e)),searchStories:(e,t)=>{let s=new URLSearchParams({q:e,...t});return apiRequest("/stories/search?".concat(s))},getStoryComments:e=>apiRequest("/stories/".concat(e,"/comments")),addComment:(e,t,s)=>apiRequest("/stories/".concat(e,"/comments"),{method:"POST",body:JSON.stringify({content:t,parentComment:s})}),likeComment:(e,t)=>apiRequest("/stories/".concat(e,"/comments/").concat(t,"/like"),{method:"POST"})},o={searchStories:(e,t)=>{let s=t?Object.fromEntries(Object.entries(t).filter(e=>{let[t,s]=e;return null!=s&&""!==s})):{},a=new URLSearchParams({q:e,...s});return console.log("API call URL:","/search/stories?".concat(a)),apiRequest("/search/stories?".concat(a))},searchUsers:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/users?".concat(t))},getSearchSuggestions:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/suggestions?".concat(t))},getSearchFilters:()=>apiRequest("/search/filters"),globalSearch:e=>{let t=new URLSearchParams({q:e});return apiRequest("/search/global?".concat(t))}},l={getAllStories:e=>apiRequest("/admin/stories".concat(e?"?".concat(e):"")),getStoryForReview:e=>apiRequest("/admin/stories/".concat(e)),approveStory:e=>apiRequest("/admin/stories/".concat(e,"/approve"),{method:"PATCH"}),rejectStory:(e,t)=>apiRequest("/admin/stories/".concat(e,"/reject"),{method:"PATCH",body:JSON.stringify({reason:t})}),bulkApproveStories:e=>apiRequest("/admin/stories/bulk-approve",{method:"PATCH",body:JSON.stringify({storyIds:e})}),bulkRejectStories:(e,t)=>apiRequest("/admin/stories/bulk-reject",{method:"PATCH",body:JSON.stringify({storyIds:e,reason:t})}),getAllUsers:e=>apiRequest("/users/admin/all".concat(e?"?".concat(e):"")),suspendUser:(e,t,s)=>apiRequest("/admin/users/".concat(e,"/suspend"),{method:"PATCH",body:JSON.stringify({reason:t,duration:s})}),unsuspendUser:e=>apiRequest("/admin/users/".concat(e,"/unsuspend"),{method:"PATCH"}),deleteUser:e=>apiRequest("/users/".concat(e),{method:"DELETE"}),getAllAdmins:()=>apiRequest("/admin/admins"),getAdminProfile:()=>apiRequest("/admin/profile"),updateAdminProfile:e=>apiRequest("/admin/profile",{method:"PATCH",body:JSON.stringify(e)}),getAdminSettings:()=>apiRequest("/admin/settings"),updateAdminSettings:e=>apiRequest("/admin/settings",{method:"PATCH",body:JSON.stringify(e)}),getAnalytics:()=>apiRequest("/admin/analytics"),getDashboardStats:()=>apiRequest("/admin/dashboard-stats")}},86981:function(e,t,s){"use strict";s.d(t,{E$:function(){return getAvatarUrl},Jn:function(){return getImageUrl}});let getImageUrl=(e,t)=>{if(!e)return t||"https://ui-avatars.com/api/?name=User&background=6366f1&color=fff&size=150";if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("blob:"))return e;let s=e.startsWith("/")?e:"/".concat(e);return"".concat("https://api.dhyey.delpat.in/api/v1").concat(s)},getAvatarUrl=e=>getImageUrl(e,"https://ui-avatars.com/api/?name=User&background=6366f1&color=fff&size=150")},86965:function(e,t,s){"use strict";s.d(t,{Am:function(){return r},D2:function(){return a}});let ToastManager=class ToastManager{subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}show(e){this.listeners.forEach(t=>t(e))}constructor(){this.listeners=new Set}};let a=new ToastManager,showToast=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;a.show({message:e,type:t,duration:s})},r={success:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;return showToast(e,"success",t)},error:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;return showToast(e,"error",t)},info:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;return showToast(e,"info",t)},warning:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;return showToast(e,"warning",t)}}},96871:function(e,t,s){e.exports=s(92054)}},function(e){e.O(0,[2054,6895,7115,2835,1744],function(){return e(e.s=41486)}),_N_E=e.O()}]);